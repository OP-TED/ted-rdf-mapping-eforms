#--- MG-Lot common ---
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rml: <http://semweb.mmlab.be/ns/rml#> .
@prefix ql: <http://semweb.mmlab.be/ns/ql#> .
@prefix locn: <http://www.w3.org/ns/locn#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix tedm: <http://data.europa.eu/a4g/mapping/sf-rml/> .
@prefix epd: <http://data.europa.eu/a4g/resource/> .
@prefix epo: <http://data.europa.eu/a4g/ontology#> .
@prefix epo-not: <http://data.europa.eu/a4g/ontology#>.
@prefix cv: <http://data.europa.eu/m8g/> .
@prefix cccev: <http://data.europa.eu/m8g/> .
@prefix org: <http://www.w3.org/ns/org#> .
@prefix cpov: <http://data.europa.eu/m8g/> .
@prefix	foaf: <http://xmlns.com/foaf/0.1/> .
@prefix time: <http://www.w3.org/2006/time#>.
@prefix adms: <http://www.w3.org/ns/adms#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix fnml:   <http://semweb.mmlab.be/ns/fnml#> .
@prefix fno: <https://w3id.org/function/ontology#> .
@prefix idlab-fn: <http://example.com/idlab/function/> .

tedm:MG-Lot_ND-Lot a rr:TriplesMap ;
    rdfs:label "MG-Lot" ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-Lot" ;
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_Lot_{cbc:ID}" ;
            rr:class epo:Lot
        ]  ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-767-Lot and BT-122-Lot ";
            rr:predicate epo:usesTechnique ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-EAuctionTechnique-usesTechnique-Lot_ND-AuctionTerms ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-766-Lot ";
            rr:predicate epo:usesTechnique ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-DynamicPurchaseSystemTechnique-usesTechnique-Lot_ND-LotTenderingProcess ;
                    rr:joinCondition [
                       rr:child "path(.)";
                         rr:parent "path(../.)";
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-123-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-AuctionTerms ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-97-Lot (object)" ;
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotSubmissionLanguage ;
                    rr:joinCondition [
                        rr:child  "path(.)" ;
                        rr:parent "path(../..)" ;
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-764-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotECatalog ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-708-Lot, BT-615-Lot, BT-15-Lot, BT-14-Lot, BT-737-Lot, BT-707-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-AccessTerm-isSubjectToLotSpecificTerm-Lot_ND-LotProcurementDocument;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-99-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ReviewTerm-isSubjectToLotSpecificTerm-Lot_ND-ReviewPresentationPeriod ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-63-Lot, BT-769-Lot, OPT-301-Lot-TenderEval connection to ProcedureTerm, BT-97-Lot, BT-98-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingTerms ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-765-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-FrameworkAgreementTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingProcess ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-751-Lot, BT-75-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-FinancialGuarantee;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-113-Lot, BT-109-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-FrameworkAgreementTerm-isSubjectToLotSpecificTerm-Lot_ND-FA  ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-111-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-FrameworkAgreementTerm-isSubjectToLotSpecificTerm-Lot_ND-FABuyerCategories  ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
      rr:predicateObjectMap
        [
            rdfs:label "Composition relationship between Lot and SubmissionTerm";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-TenderRecipient   ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-52-Lot, BT-130-Lot, BT-631-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-MultipleStageProcedureTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingProcess  ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-51-Lot and BT-50-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-MultipleStageProcedureTerm-isSubjectToLotSpecificTerm-Lot_ND-SecondStage ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-131(d)-Lot and BT-131(t)-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-SubmissionDeadline ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-13(d)-Lot and BT-13(t)-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-AccessTerm-isSubjectToLotSpecificTerm-Lot_ND-LotInfoRequestPeriod ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-1311(d)-Lot and BT-1311(t)-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-ParticipationRequestPeriod ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-134-Lot, BT-132(d)-Lot, BT-132(t)-Lot and BT-133-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-OpeningTerm-isSubjectToLotSpecificTerm-Lot_ND-PublicOpening ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-133-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Address-definesOpeningPlace-OpeningTerm-isSubjectToLotSpecificTerm-Lot_ND-PublicOpeningPlace;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-17-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingProcess;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-44-Lot, BT-644-Lot, BT-41-Lot and BT-45-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-DesignContestRegimeTerm-isSubjectToLotSpecificTerm-Lot_ND-AwardingTerms;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-771-Lot, BT-772-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LateTendererInformation;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "OPT-301-Lot-AddInfo, OPT-301-Lot-DocProvider" ;
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-AccessTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingTerms ;
                    rr:joinCondition [
                            rr:child "path(.)" ;
                            rr:parent "path(..)" ;
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap [
            rdfs:label "BT-124-Lot";
            rr:predicate epo:usesChannel ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-AdHocChannel-usesChannel-Lot_ND-LotTenderingProcess;
                    rr:joinCondition [
                         rr:child "cbc:ID";
                        rr:parent "../cbc:ID";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-632-Lot";
            rr:predicate epo:usesChannel ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-AdHocChannel-usesChannel-Lot_ND-LotTenderingProcessExtension;
                    rr:joinCondition [
                        rr:child "cbc:ID";
                        rr:parent "../cbc:ID";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-137-Lot" ;
            rdfs:comment "Purpose Lot Identifier of MG-Lot under ND-Lot" ;
            rr:predicate adms:identifier ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Identifier-identifier-Lot_ND-Lot ;
                    rr:joinCondition [
                        rr:child "cbc:ID";
                        rr:parent "cbc:ID";
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-22-Lot" ;
            rdfs:comment "Internal Identifier of MG-Lot under ND-LotProcurementScope" ;
            rr:predicate epo:hasInternalIdentifier  ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Identifier-hasInternalIdentifier-Lot_ND-LotProcurementScope ;
                    rr:joinCondition [
                        rr:child "cbc:ID";
                         rr:parent "../cbc:ID";
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "ND-ExclusionGrounds";
            rr:predicate epo:specifiesProcurementCriterion ;
            rr:objectMap
                [
                    # this is an example of a relationship for all occurrences of a subject, therefore not needing a joinCondition
                    rr:parentTriplesMap tedm:MG-ExclusionGround-specifiesProcurementCriterion-Lot_ND-ExclusionGrounds ;
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-7220-Lot and BT-5010-Lot";
            rr:predicate epo:isFundedBy ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Fund-isFundedBy-Lot_ND-Funding;
                    rr:joinCondition [
                        rr:child "cbc:ID";
                        rr:parent "../../../../../../cbc:ID";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-747-Lot, BT-749-Lot, BT-748-Lot, BT-40-Lot and BT-750-Lot ";
            rr:predicate epo:specifiesProcurementCriterion;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SelectionCriterion-specifiesProcurementCriterion-Lot_ND-SelectionCriteria;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../../../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-7532-Lot and BT-752-Lot-ThresholdNumber";
            rr:predicate epo:specifiesProcurementCriterion;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SelectionCriterion-specifiesProcurementCriterion-Lot_ND-SelectionCriteria ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../../../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-539-Lot, BT-540-Lot and BT-734-Lot";
            rr:predicate epo:specifiesProcurementCriterion;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-AwardCriterion-specifiesProcurementCriterion-Lot_ND-LotAwardCriterion ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-5421 and BT-541";
            rr:predicate epo:specifiesProcurementCriterion;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-AwardCriterion-specifiesProcurementCriterion-Lot_ND-LotAwardWeightCriterionParameter;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../../../../../../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-5422-Lot and BT-541-Lot-FixedNumber";
            rr:predicate epo:specifiesProcurementCriterion;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-AwardCriterion-specifiesProcurementCriterion-Lot_ND-LotAwardWeightCriterionParameter;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../../../../../../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-71-Lot";
            rr:predicate epo:specifiesProcurementCriterion;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ParticipationCondition-specifiesProcurementCriterion-Lot_ND-LotReservedParticipation;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-733-Lot, BT-543-Lot" ;
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-AwardEvaluationTerm-isSubjectToLotSpecificTerm-Lot_ND-LotAwardCriteria ;
                    rr:joinCondition[
                        rr:child "path(.)";
                        rr:parent "path(../../..)";
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-120-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-MultipleStageProcedureTerm-isSubjectToLotSpecificTerm-Lot_ND-AwardingTerms;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-76-Lot";
            rr:predicate epo:foreseesContractSpecificTerm;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-TendererLegalForm;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-727-Lot";
            rr:predicate epo:foreseesContractSpecificTerm;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotPerformanceAddress;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-728-Lot";
            rr:predicate epo:foreseesContractSpecificTerm;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotPlacePerformance;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-54-Lot, and BT-58-Lot";
            rr:predicate epo:foreseesContractSpecificTerm;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-OptionsAndRenewals;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-57-Lot";
            rr:predicate epo:foreseesContractSpecificTerm;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-OptionsDescription;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-271-Lot";
            rr:predicate epo:hasLaunchFrameworkAgreementMaximumValue;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-MonetaryValue-hasLaunchFrameworkAgreementMaximumValue-Lot_ND-LotValueEstimateExtension;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../../../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "OPT-301-Lot-ReviewOrg, OPT-301-Lot-ReviewInfo" ;
            rr:predicate epo:isSubjectToLotSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ReviewTerm-isSubjectToLotSpecificTerm-Lot_ND-LotReviewTerms ;
                    rr:joinCondition [
                        rr:child "path(.)" ;
                        rr:parent "path(../..)" ;
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-736-Lot";
            rr:predicate epo:foreseesContractSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotReservedExecution;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-743-Lot";
            rr:predicate epo:foreseesContractSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotEInvoicing;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-70-Lot";
            rr:predicate epo:foreseesContractSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-ExecutionRequirements;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
             rdfs:label "BT-77-Lot";
            rr:predicate epo:foreseesContractSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-PaymentTerms;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ]
        ] ;
     rr:predicateObjectMap
        [
             rdfs:label "BT-531-Lot";
            rr:predicate epo:foreseesContractSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotContractAdditionalNature;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-92-Lot, BT-93-Lot";
            rr:predicate epo:foreseesContractSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-PostAwardProcess;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-65-Lot, BT-64-Lot and BT-729-Lot";
            rr:predicate epo:foreseesContractSpecificTerm ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubcontractTerm-foreseesContractSpecificTerm-Lot_ND-SubcontractingObligation;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-78-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm  ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SecurityClearanceTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingTerms;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-587-Lot";
            rr:predicate epo:isSubjectToLotSpecificTerm  ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SecurityClearanceTerm-isSubjectToLotSpecificTerm-Lot_ND-SecurityClearanceTerms;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-801-Lot, BT-802-Lot ";
            rr:predicate epo:isSubjectToLotSpecificTerm  ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-NonDisclosureAgreementTerm-isSubjectToLotSpecificTerm-Lot_ND-NDA;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-744-Lot ";
            rr:predicate epo:isSubjectToLotSpecificTerm  ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotESignature;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-651-Lot ";
            rr:predicate epo:isSubjectToLotSpecificTerm  ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-SubcontractingIndication;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../../../../..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-79-Lot";
            rr:predicate epo:specifiesProcurementCriterion ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ProcurementCriterion-specifiesProcurementCriterion-Lot_ND-LotTenderingTerms;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(..)";
                    ];
                ]
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-717-Lot";
            rr:predicate epo:fulfillsStrategicProcurement ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-GreenProcurement-fulfillsStrategicProcurement-Lot_ND-StrategicProcurementLot ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../../../../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-777-Lot";
            rr:predicate epo:fulfillsStrategicProcurement ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-StrategicProcurement-fulfillsStrategicProcurement-Lot_ND-StrategicProcurementType ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-754-Lot";
            rr:predicate epo:fulfillsStrategicProcurement ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-StrategicProcurement-fulfillsStrategicProcurement-Lot-Lot_ND-AccessibilityJustification ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ];
     rr:predicateObjectMap
        [
            rdfs:label "BT-805-Lot";
            rr:predicate epo:fulfillsStrategicProcurement ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-GreenProcurement-fulfillsStrategicProcurement-Lot_ND-LotGreenCriteria ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-262-Lot";
            rr:predicate epo:hasPurpose  ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Purpose-hasPurpose-Lot_ND-LotAdditionalClassification ;
                    rr:joinCondition [
                       rr:child "path(.)";
                       rr:parent "path(..)";
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-775-Lot";
            rr:predicate epo:fulfillsStrategicProcurement   ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SocialProcurement-fulfillsStrategicProcurement-Lot_ND-LotSocialObjectiveType ;
                    rr:joinCondition [
                       rr:child "path(.)";
                         rr:parent "path(../..)";
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-776-Lot";
            rr:predicate epo:fulfillsStrategicProcurement   ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-InnovativeProcurement-fulfillsStrategicProcurement-Lot_ND-LotInnovativeAcquisitionType ;
                    rr:joinCondition [
                       rr:child "path(.)";
                         rr:parent "path(../..)";
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-774-Lot";
            rr:predicate epo:fulfillsStrategicProcurement   ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-GreenProcurement-fulfillsStrategicProcurement-Lot_ND-LotEnvironmentalImpactType ;
                    rr:joinCondition [
                       rr:child "path(.)";
                         rr:parent "path(../..)";
                    ];
                ] ;
        ] ;
.

tedm:MG-Lot_ND-LotProcurementScope a rr:TriplesMap ;
    rdfs:label "MG-Lot";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label  "ND-LotProcurementScope";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_Lot_{../cbc:ID}" ;
            rr:class epo:Lot
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-21-Lot" ;
            rdfs:comment "Title of MG-Lot under ND-LotProcurementScope" ;
            rr:predicate  dct:title ;
            rr:objectMap
                [
                    rdfs:label "BT-21-Lot-Language" ;
                    rdfs:comment "Language of Title of MG-Lot under ND-LotProcurementScope" ;
                    rml:reference "cbc:Name";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap  [ rml:reference "cbc:Name/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-24-Lot" ;
            rdfs:comment "Description of MG-Lot under ND-LotProcurementScope" ;
            rr:predicate  dct:description  ;
            rr:objectMap
                [
                    rdfs:label "BT-24-Lot-Language" ;
                    rdfs:comment "Language of Description of MG-Lot under ND-LotProcurementScope" ;
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap  [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-23-Lot, BT-5101(a)-Lot, BT-5101(b)-Lot, BT-5101(s)-Lot, BT-5131-Lot, BT-5121-Lot, BT-5071-Lot, BT-5141-Lot, BT-36-Lot";
            rr:predicate epo:foreseesContractSpecificTerm;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotProcurementScope;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-726-Lot";
            rdfs:comment "Suitable For SMEs of MG-Lot under ND-LotProcurementScope" ;
            rr:predicate  epo:isSMESuitable;
            rr:objectMap
                [
                    rml:reference "cbc:SMESuitableIndicator";
                    rr:datatype xsd:boolean ;

                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-25-Lot and BT-625-Lot";
            rdfs:comment "Quantity of MG-Lot under ND-LotProcurementScope";
            rr:predicate epo:hasPurpose ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Purpose-hasPurpose-Lot_ND-LotProcurementScope;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(.)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-262-Lot";
            rdfs:comment "Main Classification Code of MG-Lot under ND-LotProcurementScope";
            rr:predicate epo:hasPurpose ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Purpose-hasPurpose-Lot_ND-LotMainClassification;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-27-Lot";
            rdfs:comment "Estimated Value of MG-Lot under ND-LotProcurementScope";
            rr:predicate epo:hasEstimatedValue ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-MonetaryValue-hasEstimatedValue-Lot_ND-LotValueEstimate;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(..)";
                    ];
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-300-Lot";
            rdfs:comment "Estimated Value of MG-Lot under ND-LotProcurementScope";
            rr:predicate  epo:hasAdditionalInformation;
            rr:objectMap
                [
                    rdfs:label "BT-300-Lot-Language";
                    rdfs:comment "Language of Estimated Value of MG-Lot under ND-LotProcurementScope";
                    rml:reference "if(exists(descendant::cbc:Note)) then descendant::cbc:Note else null";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap  [ rml:reference "cbc:Note/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
 .

tedm:MG-Identifier-identifier-Lot_ND-Lot a rr:TriplesMap ;
    rdfs:label "BT-137-Lot";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rml:reference "if (exists(cbc:ID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_LotIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class adms:Identifier
        ] ;
    rr:predicateObjectMap
        [

            rr:predicate skos:notation ;
            rr:objectMap
                [
                    rml:reference "cbc:ID";
                ] ;
        ];
     rr:predicateObjectMap
        [
            rdfs:label "BT-137-Lot-Scheme" ;
            rdfs:comment "Scheme of MG-Identifier under ND-Lot" ;
            rr:predicate epo:hasScheme ;
            rr:objectMap
                [
                    rml:reference "cbc:ID/@schemeName";
                ] ;
        ] ;
.

tedm:MG-Identifier-hasInternalIdentifier-Lot_ND-LotProcurementScope a rr:TriplesMap ;
    rdfs:label "MG-Identifier";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label  "ND-LotProcurementScope";
            rml:reference "if (exists(cbc:ID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_LotInternalIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class adms:Identifier
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-22-Lot" ;
            rdfs:comment "Internal Identifier of MG-Lot under ND-LotProcurementScope" ;
            rr:predicate skos:notation ;
            rr:objectMap
                [
                    rml:reference "cbc:ID";
                ] ;
        ];
     rr:predicateObjectMap
        [
            rdfs:label "BT-22-Lot-Scheme" ;
            rdfs:comment "Scheme of MG-Identifier under ND-LotProcurementScope" ;
            rr:predicate epo:hasScheme ;
            rr:objectMap
                [
                    rml:reference "cbc:ID/@schemeName";
                ] ;
        ] ;
.

# this is an example of a linked resource that is instantiated on an iterator that repeats, but for a parent resource that does not
tedm:MG-Identifier-identifier-PlanningNotice-refersToPrevious-Notice_ND-LotPreviousPlanning a rr:TriplesMap ;
    rdfs:label "MG-Identifier";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:NoticeDocumentReference";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotPreviousPlanning";
            # this is an example of an IRI component hashing on an explicit element to prevent unwanted instances (owing to an iterator that has repeating elements)
            rml:reference "if (exists(cbc:ID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(cbc:ID, ' ', '-' ), '/' , '-') || '_PlanningNoticeIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(cbc:ID) || '?response_type=raw') else null" ;
            rr:class adms:Identifier
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-125(i)-Lot";
            rdfs:comment "Previous Planning Identifier of MG-Identifier under ND-LotPreviousPlanning";
            rr:predicate skos:notation ;
            rr:objectMap
                [
                    rml:reference "cbc:ID";
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-125(i)-Lot-Scheme" ;
            rdfs:comment "Scheme of MG-Identifier under ND-LotPreviousPlanning" ;
            rr:predicate epo:hasScheme ;
            rr:objectMap
                [
                    rml:reference "cbc:ID/@schemeName";
                ] ;
        ] ;
.

# this is an example of an external root resource (Notice) instantiation for referencing
tedm:MG-PlanningNotice-refersToPrevious-Notice_ND-LotPreviousPlanning a rr:TriplesMap ;
    rdfs:label "MG-PlanningNotice";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:NoticeDocumentReference";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotPreviousPlanning";
            # we use the ID at this level to create an IRI with the pattern of a Notice
            rml:reference "if (exists(cbc:ID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(cbc:ID, ' ', '-' ), '/' , '-') || '_Notice' else null" ;
            rr:class epo-not:PlanningNotice
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-125(i)-Lot";
            rdfs:comment "Previous Planning Identifier of MG-PlanningNotice under ND-LotPreviousPlanning ";
            rr:predicate adms:identifier ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Identifier-identifier-PlanningNotice-refersToPrevious-Notice_ND-LotPreviousPlanning ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(.)";
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-1251-Lot";
            rdfs:comment "Previous Planning Part Identifier of MG-PlanningNotice under ND-LotPreviousPlanning ";
            rr:predicate epo:announcesPlannedProcurementPart ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-PlannedProcurementPart-announcesPlannedProcurementPart-PlanningNotice-refersToPrevious-Notice_ND-LotPreviousPlanning;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(.)";
                    ];
                ] ;
        ]
.

tedm:MG-Notice_ND-LotPreviousPlanning a rr:TriplesMap ;
    rdfs:label "MG-Notice";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:NoticeDocumentReference";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotPreviousPlanning";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_Notice" ;
            rr:class epo:Notice
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-125(i)-Lot and BT-1251-Lot";
            rdfs:comment "Previous Planning Identifier of MG-Notice under ND-LotPreviousPlanning ";
            rr:predicate epo:refersToPrevious ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-PlanningNotice-refersToPrevious-Notice_ND-LotPreviousPlanning ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(.)";
                    ];
                ] ;
        ] ;
.

# this is an example of a second-degree linked resource of a linked external resource
tedm:MG-Identifier-identifier-PlannedProcurementPart-announcesPlannedProcurementPart-PlanningNotice-refersToPrevious-Notice_ND-LotPreviousPlanning a rr:TriplesMap ;
    rdfs:label "MG-Identifier";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:NoticeDocumentReference";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotPreviousPlanning";
            rml:reference "if (exists(cbc:ReferencedDocumentInternalAddress)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(cbc:ID, ' ', '-' ), '/' , '-') || '_PlannedProcurementPartIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(cbc:ID) || '?response_type=raw') else null" ;
            rr:class adms:Identifier
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-1251-Lot";
            rdfs:comment "Previous Planning Part Identifier of MG-Identifier under ND-LotPreviousPlanning ";
            rr:predicate skos:notation ;
            rr:objectMap
                [
                    rml:reference "cbc:ReferencedDocumentInternalAddress";
                ] ;
        ]
.

# this is an example of a linked resource of a linked external resource
tedm:MG-PlannedProcurementPart-announcesPlannedProcurementPart-PlanningNotice-refersToPrevious-Notice_ND-LotPreviousPlanning a rr:TriplesMap ;
    rdfs:label "MG-PlannedProcurementPart";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:NoticeDocumentReference";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotPreviousPlanning";
            rml:reference "if (exists(cbc:ReferencedDocumentInternalAddress)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(cbc:ID, ' ', '-' ), '/' , '-') || '_PlannedProcurementPart_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(cbc:ID) || '?response_type=raw') else null" ;
            rr:class epo:PlannedProcurementPart
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-1251-Lot";
            rdfs:comment "Previous Planning Part Identifier of MG-PlannedProcurementPart under ND-LotPreviousPlanning ";
            rr:predicate adms:identifier ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Identifier-identifier-PlannedProcurementPart-announcesPlannedProcurementPart-PlanningNotice-refersToPrevious-Notice_ND-LotPreviousPlanning ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(.)";
                    ];
                ] ;
        ]
.

tedm:MG-EAuctionTechnique-usesTechnique-Lot_ND-AuctionTerms a rr:TriplesMap ;
    rdfs:label "MG-EAuctionTechnique";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:AuctionTerms";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-AuctionTerms";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_AuctionTerms_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:EAuctionTechnique ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-767-Lot";
            rdfs:comment "Electronic Auction of MG-EAuctionTechnique under ND-AuctionTerms ";
            rr:predicate epo:hasUsage ;
            rr:objectMap
                [
                    rdfs:label "at-voc:usage";
                    rdfs:comment "translation of 'true' to at-voc:usage:used";
                    rml:reference "if(cbc:AuctionConstraintIndicator/text()='true') then 'http://publications.europa.eu/resource/authority/usage/used' else null";
                    rr:termType rr:IRI
                ] ;
            rr:objectMap
                [
                    rdfs:label "at-voc:usage";
                    rdfs:comment "translation of 'false' to at-voc:usage:n-used";
                    rml:reference "if(cbc:AuctionConstraintIndicator/text()='false') then 'http://publications.europa.eu/resource/authority/usage/n-used' else null";
                    rr:termType rr:IRI
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-122-Lot";
            rdfs:comment "Electronic Auction Description of MG-EAuctionTechnique under ND-AuctionTerms ";
            rr:predicate dct:description;
            rr:objectMap
                [
                    rdfs:label "BT-122-Lot-Language";
                    rdfs:comment "Language of Electronic Auction Description of MG-EAuctionTechnique under ND-AuctionTerms ";
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-AuctionTerms a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:AuctionTerms";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-AuctionTerms";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-123-Lot";
            rdfs:comment "Electronic Auction URL of MG-SubmissionTerm under ND-AuctionTerms ";
            rr:predicate epo:hasEAuctionURL ;
            rr:objectMap
                [
                    rml:reference "cbc:AuctionURI";
                    rr:datatype xsd:anyURI
                ] ;
        ]
.

tedm:MG-Lot_ND-LotTenderingProcess a rr:TriplesMap ;
    rdfs:label "MG-Lot";
    rml:logicalSource
        [
           rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotTenderingProcess";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_Lot_{cbc:ID}" ;
            rr:class epo:Lot
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-115-Lot";
            rdfs:comment "GPA Coverage of MG-Lot under ND-LotTenderingProcess";
            rr:predicate epo:isCoveredByGPA  ;
            rr:objectMap
                [
                    rml:reference "cac:TenderingProcess/cbc:GovernmentAgreementConstraintIndicator";
                    rr:datatype xsd:boolean
                ] ;
        ]
.

tedm:MG-FrameworkAgreementTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingProcess a rr:TriplesMap ;
    rdfs:label "MG-FrameworkAgreementTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotTenderingProcess";
            rml:reference "if(exists(cac:ContractingSystem/cbc:ContractingSystemTypeCode[@listName='framework-agreement'])) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_FrameworkAgreementTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null";
            rr:class  epo:FrameworkAgreementTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-765-Lot";
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.9 from v1.3-1.8 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute and other mapping-irrelevant changes
            rdfs:comment "Framework Agreement of MG-FrameworkAgreementTerm under ND-LotFAContractingSystem (v1.9+), ND-LotTenderingProcess (v1.3-1.8) ";
            rr:predicate epo:hasFrameworkAgreementType ;
            rr:objectMap
                [
                    rdfs:label "at-voc:framework-agreement" ;
                    rr:parentTriplesMap tedm:framework-agreement ;
                    rr:joinCondition [
                        rr:child "cac:ContractingSystem/cbc:ContractingSystemTypeCode[@listName='framework-agreement']";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ]
.

tedm:MG-DynamicPurchaseSystemTechnique-usesTechnique-Lot_ND-LotTenderingProcess a rr:TriplesMap ;
    rdfs:label "MG-DynamicPurchaseSystemTechnique";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotTenderingProcess";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_DynamicPurchaseSystemTechnicalUsage_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:DynamicPurchaseSystemTechnique
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.9 from v1.3-1.8 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute and other mapping-irrelevant changes
            rdfs:label "BT-766-Lot";
            rdfs:comment "Dynamic Purchasing System of MG-DynamicPurchaseSystemTechnique under ND-LotTenderingProcess";
            rr:predicate epo:hasDPSScope ;
            rr:objectMap
                [
                    rdfs:label "at-voc:dps-usage" ;
                    rr:parentTriplesMap tedm:dps-usage ;
                    rr:joinCondition [
                        rr:child "cac:ContractingSystem/cbc:ContractingSystemTypeCode[@listName='dps-usage']";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ]
.

tedm:MG-FrameworkAgreementTerm-isSubjectToLotSpecificTerm-Lot_ND-FA a rr:TriplesMap ;
    rdfs:label "MG-FrameworkAgreementTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:FrameworkAgreement";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-FA";
            rml:reference "if((exists(cbc:MaximumOperatorQuantity)) or(exists(cbc:Justification))) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_FrameworkAgreementTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw') else null";
            rr:class epo:FrameworkAgreementTerm
        ] ;
    rr:predicateObjectMap
        [

            rdfs:label "BT-113-Lot";
            rdfs:comment "Framework Maximum Participants Number of MG-FrameworkAgreementTerm under ND-FA";
            rr:predicate epo:hasMaximumParticipantsNumber ;
            rr:objectMap
                [
                    rml:reference "cbc:MaximumOperatorQuantity";
                    rr:datatype xsd:integer;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-109-Lot";
            rdfs:comment "Framework Duration Justification of MG-FrameworkAgreementTerm under ND-FA";
            rr:predicate epo:hasDurationExtensionJustification ;
            rr:objectMap
                [
                    rdfs:label "BT-109-Lot-Language";
                    rdfs:comment "Language of Framework Duration Justification of MG-FrameworkAgreementTerm under ND-FA";
                    rml:reference "cbc:Justification";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Justification/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-FrameworkAgreementTerm-isSubjectToLotSpecificTerm-Lot_ND-FABuyerCategories a rr:TriplesMap ;
    rdfs:label "MG-FrameworkAgreementTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:FrameworkAgreement/cac:SubsequentProcessTenderRequirement[cbc:Name/text()='buyer-categories']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-FABuyerCategories";
            rml:reference "if(exists(cbc:Description)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_FrameworkAgreementTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw') else null";
            rr:class epo:FrameworkAgreementTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-111-Lot";
            rdfs:comment "Framework Buyer Categories of MG-FrameworkAgreementTerm under ND-FABuyerCategories";
            rr:predicate epo:hasBuyerCategoryDescription ;
            rr:objectMap
                [
                    rdfs:label "BT-111-Lot-Language";
                    rdfs:comment "Language of Framework Buyer Categories of MG-FrameworkAgreementTerm under ND-FABuyerCategories";
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-MultipleStageProcedureTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingProcess a rr:TriplesMap ;
    rdfs:label "MG-MultipleStageProcedureTerm";
    rdfs:comment "different from old mapping";
    rml:logicalSource
        [
             rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotTenderingProcess";
            rml:reference "if (exists(cbc:CandidateReductionConstraintIndicator) or exists(cac:InvitationSubmissionPeriod) or exists(cac:ParticipationInvitationPeriod)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_MultipleStageProcedureTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw') else null" ;
            rr:class  epo:MultipleStageProcedureTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-52-Lot";
            rdfs:comment "Successive Reduction Indicator (Lot) of MG-MultipleStageProcedureTerm under ND-LotTenderingProcess";
            rr:predicate epo:hasSuccessiveReduction ;
            rr:objectMap
                [
                    rml:reference "cbc:CandidateReductionConstraintIndicator";
                    rr:datatype xsd:boolean
                ] ;
        ];
rr:predicateObjectMap
        [
            rdfs:label "BT-130-Lot";
            rdfs:comment "Dispatch Invitation Tender of MG-MultipleStageProcedureTerm under ND-LotTenderingProcess";
            rr:predicate epo:hasEstimatedInvitationToTenderDate ;
            rr:objectMap
                [
                    rml:reference "cac:InvitationSubmissionPeriod/cbc:StartDate";
                    rr:datatype xsd:date;
                ] ;
        ];
rr:predicateObjectMap
        [
            rdfs:label "BT-631-Lot";
            rdfs:comment "Dispatch Invitation Interest of MG-MultipleStageProcedureTerm under ND-LotTenderingProcess";
            rr:predicate epo:hasEstimatedInvitationToExpressInterestDate ;
            rr:objectMap
                [
                    rml:reference "cac:ParticipationInvitationPeriod/cbc:StartDate";
                    rr:datatype xsd:date;
                ] ;
        ]
.

tedm:MG-MultipleStageProcedureTerm-isSubjectToLotSpecificTerm-Lot_ND-SecondStage a rr:TriplesMap ;
    rdfs:label "MG-MultipleStageProcedureTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:EconomicOperatorShortList";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-SecondStage";
            rml:reference "if (exists(cbc:LimitationDescription) or exists(cbc:MaximumQuantity) or exists(cbc:MinimumQuantity)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_MultipleStageProcedureTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw') else null" ;
            rr:class epo:MultipleStageProcedureTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-51-Lot";
            rdfs:comment "Maximum Candidates Number of MG-MultipleStageProcedureTerm under ND-SecondStage";
            rr:predicate epo:hasMaximumNumberOfCandidates ;
            rr:objectMap
                [
                    rml:reference "cbc:MaximumQuantity";
                    rr:datatype xsd:integer
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-50-Lot";
            rdfs:label "Minimum Candidates of MG-MultipleStageProcedureTerm under ND-SecondStage";
            rr:predicate epo:hasMinimumNumberOfCandidates ;
            rr:objectMap
                [
                    rml:reference "cbc:MinimumQuantity";
                    rr:datatype xsd:integer ;
                ] ;
        ]
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-SubmissionDeadline a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:TenderSubmissionDeadlinePeriod";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-SubmissionDeadline";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
 rr:predicateObjectMap
        [
            rdfs:label "BT-131(d)-Lot and BT-131(t)-Lot";
            rdfs:comment "Deadline Receipt Tenders of MG-SubmissionTerm under ND-SubmissionDeadline (incl. Time)";
            rr:predicate epo:hasReceiptTenderDeadline ;
            rr:objectMap
                [
                    rml:reference "if(exists(cbc:EndDate) and exists(cbc:EndTime) and contains(cbc:EndDate, '+')) then substring-before(cbc:EndDate, '+') || 'T' || cbc:EndTime else if(exists(cbc:EndDate) and exists(cbc:EndTime)) then cbc:EndDate || 'T' || cbc:EndTime else if(exists(cbc:EndDate)) then cbc:EndDate else null";
                    rr:datatype xsd:dateTime;
                ] ;
        ]
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-InterestExpressionReceptionPeriod a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:InterestExpressionReceptionPeriod";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-InterestExpressionReceptionPeriod";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../../../../../..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
 rr:predicateObjectMap
        [
            rdfs:label "BT-630(d)-Lot and BT-630(t)-Lot";
            rdfs:comment "DeadlineReceiptExpressions of MG-SubmissionTerm under ND-InterestExpressionReceptionPeriod (incl. Time)";
            rr:predicate epo:hasReceiptExpressionDeadline  ;
            rr:objectMap
                [
                    rml:reference "if(exists(cbc:EndDate) and exists(cbc:EndTime) and contains(cbc:EndDate, '+')) then substring-before(cbc:EndDate, '+') || 'T' || cbc:EndTime else if(exists(cbc:EndDate) and exists(cbc:EndTime)) then cbc:EndDate || 'T' || cbc:EndTime else if(exists(cbc:EndDate)) then cbc:EndDate else null";
                    rr:datatype xsd:dateTime;
                ] ;
        ]
.

tedm:MG-AccessTerm-isSubjectToLotSpecificTerm-Lot_ND-LotInfoRequestPeriod a rr:TriplesMap ;
    rdfs:label "MG-AccessTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:AdditionalInformationRequestPeriod";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
             rdfs:label "ND-LotInfoRequestPeriod";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_AccessTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}" ;
            rr:class  epo:AccessTerm
        ];
rr:predicateObjectMap
        [
            rdfs:label "BT-13(d)-Lot and BT-13(t)-Lot";
            rdfs:comment "Additional Information Deadline of MG-AccessTerm under ND-LotInfoRequestPeriod (incl. Time)";
            rr:predicate epo:hasAdditionalInformationDeadline ;
            rr:objectMap
                [
                    rml:reference "if(exists(cbc:EndDate) and exists(cbc:EndTime) and contains(cbc:EndDate, '+')) then substring-before(cbc:EndDate, '+') || 'T' || cbc:EndTime else if(exists(cbc:EndDate) and exists(cbc:EndTime)) then cbc:EndDate || 'T' || cbc:EndTime else if(exists(cbc:EndDate)) then cbc:EndDate else null";
                    rr:datatype xsd:dateTime;
                ] ;
        ]
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-ParticipationRequestPeriod a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:ParticipationRequestReceptionPeriod";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-ParticipationRequestPeriod";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-1311(d)-Lot and BT-1311(t)-Lot";
            rdfs:comment "Deadline Receipt Requests of under ND-ParticipationRequestPeriod (incl. Time)";
            rr:predicate epo:hasReceiptParticipationRequestDeadline ;
            rr:objectMap
                [
                    rml:reference "if(exists(cbc:EndDate) and exists(cbc:EndTime) and contains(cbc:EndDate, '+')) then substring-before(cbc:EndDate, '+') || 'T' || cbc:EndTime else if(exists(cbc:EndDate) and exists(cbc:EndTime)) then cbc:EndDate || 'T' || cbc:EndTime else if(exists(cbc:EndDate)) then cbc:EndDate else null";
                    rr:datatype xsd:dateTime;
                ] ;
        ]
.

tedm:MG-OpeningTerm-isSubjectToLotSpecificTerm-Lot_ND-PublicOpening a rr:TriplesMap ;
    rdfs:label "MG-OpeningTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:OpenTenderEvent";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-PublicOpening";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_OpeningTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class  epo:OpeningTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-134-Lot";
            rdfs:comment "Public Opening Description of MG-OpeningTerm under ND-PublicOpening";
            rr:predicate epo:hasOpeningDescription ;
            rr:objectMap
                [
                    rdfs:label "BT-134-Lot-Language";
                    rdfs:comment "Language of Public Opening Description of MG-OpeningTerm under ND-PublicOpening";
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-132(d)-Lot and BT-132(t)-Lot";
            rdfs:comment "Public Opening Date of MG-OpeningTerm under ND-PublicOpening (incl. Time)";
            rr:predicate epo:hasOpeningDateTime ;
            rr:objectMap
                [
                    rml:reference "if(exists(cbc:OccurrenceDate) and exists(cbc:OccurrenceTime) and contains(cbc:OccurrenceDate, '+')) then substring-before(cbc:OccurrenceDate, '+') || 'T' || cbc:OccurrenceTime else if(exists(cbc:OccurrenceDate) and exists(cbc:OccurrenceTime)) then cbc:OccurrenceDate || 'T' || cbc:OccurrenceTime else if(exists(cbc:OccurrenceDate)) then cbc:OccurrenceDate else null";
                    rr:datatype xsd:dateTime;
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-133-Lot";
            rdfs:comment "Public Opening Place of MG-OpeningTerm under ND-PublicOpeningPlace (v1.4+), ND-PublicOpening (v1.3-1.3)";
            rr:predicate epo:definesOpeningPlace ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Address-definesOpeningPlace-OpeningTerm-isSubjectToLotSpecificTerm-Lot_ND-PublicOpeningPlace ;
                    rr:joinCondition[
                        rr:child "path(..)";
                        rr:parent "path(../..)"
                    ];
                ] ;
        ]
.

tedm:MG-Address-definesOpeningPlace-OpeningTerm-isSubjectToLotSpecificTerm-Lot_ND-PublicOpeningPlace a rr:TriplesMap ;
    rdfs:label "MG-Address";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:OpenTenderEvent/cac:OccurenceLocation";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-PublicOpeningPlace";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_OpenTenderEventPlace_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class  locn:Address
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.4 from v1.3-1.3 contains rel XPath change within the same abs XPath due to node change, along with only relative XPath change, introduction of attribute and other mapping-irrelevant changes
            rdfs:label "BT-133-Lot";
            rdfs:comment "Public Opening Place of MG-Address under ND-PublicOpeningPlace (v1.4+), ND-PublicOpening (v1.3-1.3)";
            rr:predicate locn:fullAddress ;
            rr:objectMap
                [
                    rdfs:label "BT-133-Lot-Language";
                    rdfs:comment "Language of Public Opening Place of MG-Address under ND-PublicOpeningPlace";
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingProcess a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:comment "ND-LotTenderingProcess";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-17-Lot";
            rdfs:comment "SubmissionElectronic of MG-SubmissionTerm under ND-LotTenderingProcess";
            rr:predicate epo:hasESubmissionPermission ;
            rr:objectMap
                [
                    rdfs:label "at-voc:permission:" ;
                    rr:parentTriplesMap tedm:permission;
                    rr:joinCondition [
                        rr:child "if(exists(cbc:SubmissionMethodCode[@listName='esubmission'])) then cbc:SubmissionMethodCode else null" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ];
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-NonEsubmission a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess/cac:ProcessJustification";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-NonEsubmission";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions have no functional effect on this mapping
            # VERINFO: SDK v1.8+ from 1.3-1.7 contain only stylistic XPath changes (removing redundant predicate), along with introduction of List attribute and other mapping-irrelevant changes
            rdfs:label "BT-19-Lot";
            rdfs:comment "Submission Nonelectronic Justification of MG-SubmissionTerm under ND-NonEsubmission";
            rr:predicate epo:hasNonElectronicSubmissionJustification ;
            rr:objectMap
                [
                    rdfs:label "at-voc:communication-justification" ;
                    rr:parentTriplesMap tedm:communication-justification ;
                    rr:joinCondition [
                        rr:child "cbc:ProcessReasonCode[@listName='no-esubmission-justification']";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ];
    rr:predicateObjectMap
        [
            # Differences across versions have no functional effect on this mapping
            # VERINFO: SDK v1.8+ from 1.3-1.7 contain only node name change, along with introduction of Language attribute and other mapping-irrelevant changes
            rdfs:label "BT-745-Lot";
            rdfs:comment "Submission Nonelectronic Description of MG-SubmissionTerm under ND-NonEsubmission (v1.8+), ND-NoESubmission (v1.3-1.7)";
            rr:predicate epo:hasNonElectronicSubmissionDescription ;
            rr:objectMap
                [
                    rdfs:label "BT-745-Lot-Language";
                    rdfs:comment "Language of Submission Nonelectronic Description of MG-SubmissionTerm under ND-NonEsubmission" ;
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-AdHocChannel-usesChannel-Lot_ND-LotTenderingProcessExtension a rr:TriplesMap ;
    rdfs:label "MG-AdHocChannel";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotTenderingProcessExtension";
            rml:reference "if (exists(descendant::efbc:AccessToolName) or exists(cbc:AccessToolsURI)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_Channel_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:AdHocChannel
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-632-Lot";
            rdfs:comment "Tool Name of MG-AdHocChannel under ND-LotTenderingProcessExtension";
            rr:predicate dct:description  ;
            rr:objectMap
                [
                    rml:reference "descendant::efbc:AccessToolName";
                ] ;
        ]
.

tedm:MG-AdHocChannel-usesChannel-Lot_ND-LotTenderingProcess a rr:TriplesMap ;
    rdfs:label "MG-AdHocChannel";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingProcess";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotTenderingProcess";
            rml:reference "if (exists(descendant::efbc:AccessToolName) or exists(cbc:AccessToolsURI)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_Channel_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:AdHocChannel
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-124-Lot";
            rdfs:comment "Tool Atypical URL of MG-AdHocChannel under ND-LotTenderingProcess";
            rr:predicate epo:hasAddressURL  ;
            rr:objectMap
                [
                    rml:reference "cbc:AccessToolsURI";
                    rr:datatype xsd:anyURI
                ] ;
        ]
.

tedm:MG-Fund-isFundedBy-Lot_ND-Funding a rr:TriplesMap ;
    rdfs:label "MG-Fund";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:Funding";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-Funding";
            rml:reference "if (exists(efbc:FinancingIdentifier)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_LotFund_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class  epo:Fund
        ]  ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-7220-Lot";
            rdfs:comment "EUFundsProgramme of MG-Fund under ND-Funding";
            rr:predicate  epo:hasFundProgramme ;
            rr:objectMap
                [
                    tedm:minSDKVersion "1.9.1" ;
                    rdfs:label "at-EU-programme" ;
                    rr:parentTriplesMap tedm:EU-programme ;
                    rr:joinCondition [
                        rr:child "cbc:FundingProgramCode" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ]   ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-6140-Lot";
            rdfs:comment "EUFundsDetails of MG-Fund under ND-Funding";
            rr:predicate  dct:description  ;
            rr:objectMap
                [
                    tedm:minSDKVersion "1.9.1" ;
                    rdfs:label "BT-6140-Lot-Language";
                    rdfs:comment "Language of EUFundsDetails of MG-Fund under ND-Funding";
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-5010-Lot";
            rdfs:comment "EUFundsFinancingIdentifier of MG-Identifierunder ND-Funding";
            rr:predicate adms:identifier ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Identifier-identifier-Fund-isFundedBy-Lot_ND-Funding;
                ] ;
        ];
.

tedm:MG-Identifier-identifier-Fund-isFundedBy-Lot_ND-Funding a rr:TriplesMap ;
    rdfs:label "MG-Identifier";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:Funding";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-Funding";
            rml:reference "if (exists(efbc:FinancingIdentifier)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_FundIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class adms:Identifier
        ] ;
    rr:predicateObjectMap
        [
            tedm:minSDKVersion "1.9.1" ;
            rdfs:label "BT-5010-Lot";
            rdfs:comment "EUFundsFinancingIdentifier of MG-Identifierunder ND-Funding";
            rr:predicate skos:notation ;
            rr:objectMap
                [
                    rml:reference "efbc:FinancingIdentifier";
                ] ;
        ];
.

tedm:MG-SelectionCriterion-specifiesProcurementCriterion-Lot_ND-SelectionCriteria a rr:TriplesMap ;
    rdfs:label "MG-SelectionCriterion";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:SelectionCriteria";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-SelectionCriteria";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SelectionCriterion_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:SelectionCriterion
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-747-Lot";
            rdfs:comment "Selection Criteria Type of MG-SelectionCriterion under ND-SelectionCriteria";
            rr:predicate epo:hasSelectionCriterionType ;
            rr:objectMap
                [
                    rdfs:label "at-voc:selection-criterion" ;
                    rr:parentTriplesMap tedm:selection-criterion ;
                    rr:joinCondition [
                        rr:child "cbc:CriterionTypeCode[@listName='selection-criterion']" ;
                        rr:parent "code.value"
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-749-Lot";
            rdfs:comment "Selection Criteria Name of MG-SelectionCriterion under ND-SelectionCriteria";
            rr:predicate skos:prefLabel  ;
            rr:objectMap
                [
                    rdfs:label "BT-749-Lot-Language";
                    rdfs:comment "Language of Selection Criteria Name of MG-SelectionCriterion under ND-SelectionCriteria";
                    rml:reference "cbc:Name";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Name/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-750-Lot";
            rdfs:comment "Selection Criteria Description of MG-SelectionCriterion under ND-SelectionCriteria";
            rr:predicate dct:description ;
            rr:objectMap
                [
                    rdfs:label "BT-750-Lot-Language";
                    rdfs:comment "Language of Selection Criteria Description of MG-SelectionCriterion under ND-SelectionCriteria";
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-748-Lot";
            rr:predicate epo:hasSelectionCriteriaUsage ;
            rr:objectMap
                [
                    rdfs:label ":at-voc:usage" ;
                    rr:parentTriplesMap tedm:usage ;
                    rr:joinCondition [
                        rr:child "cbc:CalculationExpressionCode[@listName='usage']" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-40-Lot";
            rr:predicate epo:isUsedForCandidateRestriction;
            rr:objectMap
                [
                    rml:reference "efbc:SecondStageIndicator";
                    rr:datatype xsd:boolean;
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-5423-Lot,BT-541-Lot-ThresholdNumber" ;
            rr:predicate epo:hasConstraint ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Constraint-hasConstraint-AwardCriterion-specifiesProcurementCriterion-Lot_ND-LotAwardThresholdCriterionParameter ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../../../../../../../../..)" ;
                    ];
                ] ;
        ]

.

tedm:MG-AwardCriterion-specifiesProcurementCriterion-Lot_ND-LotAwardCriterion a rr:TriplesMap ;
    rdfs:label "MG-AwardCriterion";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:AwardingTerms/cac:AwardingCriterion/cac:SubordinateAwardingCriterion";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotAwardCriterion";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_AwardCriterion_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:AwardCriterion
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-539-Lot";
            rdfs:comment "Award Criterion Type of MG-AwardCriterion under ND-LotAwardCriterion ";
            rr:predicate epo:hasAwardCriterionType ;
            rr:objectMap
                [
                    rdfs:label "at-voc:award-criterion-type" ;
                    rr:parentTriplesMap tedm:award-criterion-type ;
                    rr:joinCondition [
                        rr:child "if(not(exists(ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:FieldsPrivacy[efbc:FieldIdentifierCode/text()='awa-cri-typ']) and cbc:AwardingCriterionTypeCode[@listName='award-criterion-type']/text() = 'unpublished' )) then cbc:AwardingCriterionTypeCode[@listName='award-criterion-type'] else null" ;
                        rr:parent "code.value"
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-540-Lot";
            rdfs:comment "Award Criterion Description of MG-AwardCriterion under ND-LotAwardCriterion";
            rr:predicate dct:description;
            rr:objectMap
                [
                    rdfs:label "BT-540-Lot-Language";
                    rdfs:comment "Language of Award Criterion Description of MG-AwardCriterion under ND-LotAwardCriterion";
                    rml:reference "if(not(exists(ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:FieldsPrivacy[efbc:FieldIdentifierCode/text()='awa-cri-des']) and cbc:Description/text() = 'unpublished' )) then cbc:Description else null";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-734-Lot";
            rdfs:comment "Award Criterion Name of MG-AwardCriterion under ND-LotAwardCriterion";
            rr:predicate  skos:prefLabel  ;
            rr:objectMap
                [
                    rdfs:label "BT-734-Lot-Language";
                    rdfs:comment "Language of Award Criterion Name of MG-AwardCriterion under ND-LotAwardCriterion";
                    rml:reference "if(not(exists(ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:FieldsPrivacy[efbc:FieldIdentifierCode/text()='awa-cri-nam']) and cbc:Name/text() = 'unpublished' )) then cbc:Name else null";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Name/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-AwardCriterion-specifiesProcurementCriterion-Lot_ND-LotAwardWeightCriterionParameter a rr:TriplesMap ;
    rdfs:label "MG-AwardCriterion";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:AwardingTerms/cac:AwardingCriterion/cac:SubordinateAwardingCriterion/ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:AwardCriterionParameter[efbc:ParameterCode/@listName='number-weight']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
                rdfs:label "ND-LotAwardWeightCriterionParameter";

            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_AwardCriterion_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../../../../..)) || '?response_type=raw')}" ;
            rr:class epo:AwardCriterion
        ] ;
    rr:predicateObjectMap
        [
            # TODO min SDK 1.3 max SDK 1.7
            rdfs:label "BT-541-Lot-WeightNumber";
            rdfs:comment "AwardCriterionWeightNumber of MG-AwardCriterion under ND-LotAwardWeightCriterionParameter";
            rr:predicate  cccev:weight ;
            rr:objectMap
                [
                    tedm:minSDKVersion "1.8" ;
                    rml:reference "if(not(exists(efac:FieldsPrivacy[efbc:FieldIdentifierCode/text()='awa-cri-num']) and efbc:ParameterNumeric/text() = '-1' )) then efbc:ParameterNumeric else null";
                    rr:datatype xsd:decimal;
                ] ;
        ];
     rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.8 from v1.3-1.7 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute and other mapping-irrelevant changes
            rdfs:label "BT-5421-Lot";
            rdfs:comment "Award Criterion Number Weight of MG-AwardCriterion under ND-LotAwardWeightCriterionParameter (v1.8+), ND-LotAwardCriterionParameter (v1.3-1.7)";
            rr:predicate epo:hasWeightValueType ;
            rr:objectMap
                [
                    rdfs:label "at-voc:number-weight" ;
                    rr:parentTriplesMap tedm:number-weight ;
                    rr:joinCondition [
                        rr:child "if(not(exists(efac:FieldsPrivacy[efbc:FieldIdentifierCode/text()='awa-cri-wei']) and efbc:ParameterCode/text() = 'unpublished' )) then efbc:ParameterCode else null" ;
                        rr:parent "code.value" ;
                    ] ;
               ] ;
        ] ;
.

tedm:MG-AwardCriterion-specifiesProcurementCriterion-Lot_ND-LotAwardFixedCriterionParameter a rr:TriplesMap ;
    rdfs:label "MG-AwardCriterion";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:AwardingTerms/cac:AwardingCriterion/cac:SubordinateAwardingCriterion/ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:AwardCriterionParameter[efbc:ParameterCode/@listName='number-fixed']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
                rdfs:label "ND-LotAwardFixedCriterionParameter";

            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_AwardCriterion_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../../../../..)) || '?response_type=raw')}" ;
            rr:class epo:AwardCriterion
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-541-Lot-FixedNumber";
            rdfs:comment "Award Criterion FixedNumber of MG-AwardCriterion under ND-LotAwardFixedCriterionParameter";
            rr:predicate  epo:hasFixedValue ;
            rr:objectMap
                [
                    tedm:minSDKVersion "1.8" ;
                    rml:reference "if(not(exists(efac:FieldsPrivacy[efbc:FieldIdentifierCode/text()='awa-cri-num']) and efbc:ParameterNumeric/text() = '-1' )) then efbc:ParameterNumeric else null";
                    rr:datatype xsd:decimal;
                ] ;
        ];
     rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.8 from v1.3-1.7 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute and other mapping-irrelevant changes
            rdfs:label "BT-5422-Lot";
            rdfs:comment "Award Criterion Number Fixed of MG-AwardCriterion under ND-LotAwardFixedCriterionParameter (v1.8+), ND-LotAwardCriterionParameter (v1.3-1.7)";
            rr:predicate epo:hasFixedValueType ;
            rr:objectMap
                [
                    rdfs:label ":at-voc:number-fixed" ;
                    rr:parentTriplesMap tedm:number-fixed ;
                    rr:joinCondition [
                        rr:child "if(not(exists(efac:FieldsPrivacy[efbc:FieldIdentifierCode/text()='awa-cri-fix']) and efbc:ParameterCode/text() = 'unpublished' )) then efbc:ParameterCode else null" ;
                        rr:parent "code.value" ;
                    ] ;
               ] ;
        ] ;
.

tedm:MG-Constraint-hasConstraint-AwardCriterion-specifiesProcurementCriterion-Lot_ND-LotAwardThresholdCriterionParameter a rr:TriplesMap ;
    rdfs:label "MG-Constraint";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:AwardingTerms/cac:AwardingCriterion/cac:SubordinateAwardingCriterion/ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:AwardCriterionParameter[efbc:ParameterCode/@listName='number-threshold']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotAwardThresholdCriterionParameter";
            rml:reference "if (exists(efbc:ParameterCode[@listName='number-threshold'])) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_LotConstraint_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../../../../..)) || '?response_type=raw') else null" ;
            rr:class cccev:Constraint
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.8 from v1.3-1.7 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute and other mapping-irrelevant changes
            rdfs:label  "BT-5423-Lot";
            rdfs:comment "Award Criterion Number Threshold of MG-Constraint under ND-LotAwardThresholdCriterionParameter (v1.8+), ND-LotAwardCriterionParameter (v1.3-1.7)";
            rr:predicate epo:hasThresholdValue ;
            rr:objectMap
                [
                    rml:reference "if(not(exists(efac:FieldsPrivacy[efbc:FieldIdentifierCode/text()='awa-cri-thr']) and efbc:ParameterCode/text() = 'unpublished' )) then efbc:ParameterNumeric else null";
                    rr:datatype xsd:decimal;
                ]
        ] ;
     rr:predicateObjectMap
        [
            rdfs:label  "BT-541-Lot-ThresholdNumber";
            rdfs:comment "Award Criterion Number Threshold of MG-Constraint under ND-LotAwardThresholdCriterionParameter";
            rr:predicate epo:hasThresholdType ;
            rr:objectMap
                [
                    rdfs:label "at-voc:number-threshold" ;
                    rr:parentTriplesMap tedm:number-threshold ;
                    rr:joinCondition [
                        rr:child "if(not(exists(efac:FieldsPrivacy[efbc:FieldIdentifierCode/text()='awa-cri-num']) and efbc:ParameterNumeric/text() = '-1' )) then efbc:ParameterCode else null" ;
                        rr:parent "code.value"
                    ] ;
                ] ;
        ] ;
.

tedm:MG-AwardEvaluationTerm-isSubjectToLotSpecificTerm-Lot_ND-LotAwardCriteria a rr:TriplesMap ;
    rdfs:label "MG-AwardEvaluationTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:AwardingTerms/cac:AwardingCriterion";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotAwardCriteria";
            rml:reference "if((exists(cbc:Description)) or (exists(cbc:CalculationExpression)) ) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_AwardEvaluationTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:AwardEvaluationTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-733-Lot";
            rdfs:comment "Award Criteria Order Justification of MG-AwardEvaluationTerm under ND-LotAwardCriteria";
            rr:predicate epo:hasAwardCriteriaOrderJustification ;
            rr:objectMap
                [
                    rdfs:label "BT-733-Lot-Language";
                    rdfs:comment "Language of Award Criteria Order Justification of MG-AwardEvaluationTerm under ND-LotAwardCriteria";
                    rml:reference "if(not(exists(ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:FieldsPrivacy[efbc:FieldIdentifierCode/text()='awa-cri-ord']) and cbc:Description/text() = 'unpublished' )) then cbc:Description else null" ;
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-543-Lot" ;
            rdfs:comment "Award Criteria Complicated of MG-AwardCriterion under ND-LotAwardCriteria" ;
            rr:predicate epo:hasAwardCriteriaEvaluationFormula ;
            rr:objectMap
                [
                    rdfs:label "BT-543-Lot-Language" ;
                    rdfs:comment "Language of Award Criteria Complicated of MG-AwardCriterion under ND-LotAwardCriteria" ;
                    rml:reference "if(not(exists(ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:FieldsPrivacy[efbc:FieldIdentifierCode/text()='awa-cri-com']) and cbc:CalculationExpression/text() = 'unpublished' )) then cbc:CalculationExpression else null" ;
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:CalculationExpression/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup,
                            tedm:idlab-fn_inputFile_language,
                            tedm:idlab-fn_fromColumn_code,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-MultipleStageProcedureTerm-isSubjectToLotSpecificTerm-Lot_ND-AwardingTerms a rr:TriplesMap ;
    rdfs:label "MG-MultipleStageProcedureTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:AwardingTerms";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label  "ND-AwardingTerms";
            rml:reference "if(exists(cbc:NoFurtherNegotiationIndicator)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_MultipleStageProcedureTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw') else null" ;
            rr:class epo:MultipleStageProcedureTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-120-Lot";
            rdfs:comment "No Negotiation Necessary of MG-MultipleStageProcedureTerm under ND-AwardingTerms";
            rr:predicate epo:hasNoNegotiationNecessary ;
            rr:objectMap
                [
                    rml:reference "cbc:NoFurtherNegotiationIndicator";
                    rr:datatype xsd:boolean;
                ] ;
        ]
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-TendererLegalForm a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:TendererQualificationRequest[not(cac:SpecificTendererRequirement)]";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label  "ND-TendererLegalForm";
            rml:reference "if(exists(cbc:CompanyLegalForm)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_ContractTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw') else null" ;
            rr:class  epo:ContractTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-76-Lot";
            rdfs:comment "Tenderer Legal Form Description of MG-ContractTerm under ND-TendererLegalForm";
            rr:predicate epo:hasLegalFormRequirement ;
            rr:objectMap
                [
                    rdfs:label "BT-76-Lot-Language";
                    rdfs:comment "Language of Tenderer Legal Form Description of MG-ContractTerm under ND-TendererLegalForm";
                    rml:reference "if (cbc:CompanyLegalFormCode[@listName='required' and text()='true']) then cbc:CompanyLegalForm else null";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:CompanyLegalForm/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-DesignContestRegimeTerm-isSubjectToLotSpecificTerm-Lot_ND-AwardingTerms a rr:TriplesMap ;
    rdfs:label "MG-DesignContestRegimeTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:AwardingTerms";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label  "ND-AwardingTerms";
            rml:reference "if(exists(cbc:FollowupContractIndicator)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_DesignContestRegimeTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw') else null" ;
            rr:class epo:DesignContestRegimeTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-41-Lot";
            rdfs:comment "FollowingContract of MG-DesignContestRegimeTerm under ND-AwardingTerms";
            rr:predicate epo:hasFollowupContract  ;
            rr:objectMap
                [
                    rml:reference "cbc:FollowupContractIndicator";
                    rr:datatype xsd:boolean;
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-42-Lot";
            rdfs:comment "JuryDecisionBinding of MG-DesignContestRegimeTerm under ND-AwardingTerms";
            rr:predicate epo:isJuryDecisionBinding   ;
            rr:objectMap
                [
                    rml:reference "cbc:BindingOnBuyerIndicator";
                    rr:datatype xsd:boolean;
                ] ;
        ];
     rr:predicateObjectMap
        [
            rdfs:label "BT-44-Lot";
            rdfs:comment "Prize rank of MG-DesignContestRegimeTerm under ND-AwardingTerms";
            rr:predicate epo:definesPrize  ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Prize-definesPrize-DesignContestRegimeTerm-isSubjectToLotSpecificTerm-Lot_ND-Prize ;
                    rr:joinCondition[
                        rr:child "path(.)";
                        rr:parent "path(..)"
                    ];
                ] ;
        ];
.

tedm:MG-Prize-definesPrize-DesignContestRegimeTerm-isSubjectToLotSpecificTerm-Lot_ND-Prize a rr:TriplesMap ;
    rdfs:label "MG-Prize";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:AwardingTerms/cac:Prize";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label  "ND-Prize";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_Prize_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:Prize
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-44-Lot";
            rdfs:comment "PrizeRank of MG-Prize under ND-Prize";
            rr:predicate epo:hasPrizeRank;
            rr:objectMap
                [
                    rml:reference "cbc:RankCode";
                    rr:datatype xsd:integer;
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-644-Lot";
            rdfs:comment "PrizeValue of MG-Prize under ND-Prize";
            rr:predicate epo:hasPrizeValue ;
            rr:objectMap
                [
                   rr:parentTriplesMap tedm:MG-MonetaryValue-hasPrizeValue-Prize-definesPrize-DesignContestRegimeTerm-isSubjectToLotSpecificTerm-Lot_ND-Prize ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(.)";
                    ];
                ] ;
        ];
.

tedm:MG-MonetaryValue-hasPrizeValue-Prize-definesPrize-DesignContestRegimeTerm-isSubjectToLotSpecificTerm-Lot_ND-Prize a rr:TriplesMap ;
    rdfs:label "MG-MonetaryValue";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:AwardingTerms/cac:Prize";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label  "ND-Prize";
            rml:reference "if (exists(cbc:ValueAmount)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_MonetaryValue_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-644-Lot";
            rdfs:comment "PrizeValue of MG-MonetaryValue under ND-Prize";
            rr:predicate epo:hasAmountValue ;
            rr:objectMap
                [
                   rml:reference "cbc:ValueAmount";
                   rr:datatype xsd:decimal;
                ] ;
        ];
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LateTendererInformation a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    # the logicalSource/iterator along with corresponding predicateObjectMaps can be found in the version-specific derivatives of this RML file
    # Versioned mappings:
    # - v1.3-1.7
    # - v1.8+
    rr:subjectMap
        [
            rdfs:label "ND-LateTendererInformation";
            # v1.3-1.7 might create an empty instance as this is not guarded against a loosely filtered iterator
            # with exists(cbc:TendererRequirementTypeCode/@listName='missing-info-submission'),
            # which is implicitly done in the iterator for v1.8+
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../../..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
.

tedm:MG-ParticipationCondition-specifiesProcurementCriterion-Lot_ND-LotReservedParticipation a rr:TriplesMap ;
    rdfs:label "MG-ParticipationCondition";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:TendererQualificationRequest[not(cbc:CompanyLegalFormCode)][not(cac:SpecificTendererRequirement/cbc:TendererRequirementTypeCode[@listName='missing-info-submission'])]/cac:SpecificTendererRequirement[cbc:TendererRequirementTypeCode/@listName='reserved-procurement']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label  "ND-LotReservedParticipation";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ParticipationCondition_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw')}" ;
            rr:class epo:ParticipationCondition
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.4-1.7 from v1.3 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with repeatable=false
            # VERINFO: SDK v1.8+ contains only stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute
            rdfs:label "BT-71-Lot";
            rdfs:comment "Reserved Participation of MG-ParticipationCondition under ND-LotReservedProcurement (v1.4+), ND-LotReservedParticipation (v1.3)";
            rr:predicate  epo:hasReservedProcurement  ;

            rr:objectMap
                [
                    tedm:minSDKVersion "1.8" ;
                    rdfs:label "at-voc:reserved-procurement" ;
                    rr:parentTriplesMap tedm:reserved-procurement ;
                    rr:joinCondition [
                        rr:child "cbc:TendererRequirementTypeCode";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ];
  .

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingTerms a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:comment "ND-LotTenderingTerms";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-63-Lot";
            rdfs:comment "Variants of MG-SubmissionTerm under ND-LotTenderingTerms";
            rr:predicate epo:hasVariantPermission ;
            rr:objectMap
                [
                    rdfs:label "at-voc:permission" ;
                    rr:parentTriplesMap tedm:permission ;
                    rr:joinCondition [
                        rr:child "cbc:VariantConstraintCode";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-769-Lot";
            rdfs:comment "Multiple Tenders of MG-SubmissionTerm under ND-LotTenderingTerms";
            rr:predicate epo:isMultipleTenderSubmissionAllowed ;
            rr:objectMap
                [
                    rdfs:comment "translation of at-voc value 'allowed' to ePO value 'true'";
                    rml:reference "if(cbc:MultipleTendersCode/text()='allowed' or cbc:MultipleTendersCode/text()='required') then 'true' else null";
                    rr:datatype xsd:boolean;
                ]
                ,
                [
                    rdfs:comment "translation of at-voc value 'not-allowed' to ePO value 'false'";
                    rml:reference "if(cbc:MultipleTendersCode/text()='not-allowed') then 'false' else null";
                    rr:datatype xsd:boolean;
                ]
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-98-Lot (object)";
            rdfs:comment "Connection of MG-SubmissionTerm to MG-SpecificDuration under ND-LotTenderingTerms";
            rr:predicate epo:hasTenderValidityDuration ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SpecificDuration-hasTenderValidityDuration-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingTerms ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(..)";
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "OPT-301-Lot-TenderEval" ;
            rdfs:comment "Connection of MG-SubmissionTerm to MG-TenderProcessor under ND-LotTenderingTerms" ;
            rr:predicate epo:definesTenderProcessor ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-TenderProcessor_ND-LotTenderingTerms ;
                    rr:joinCondition [
                        rr:child "path(.)" ;
                        rr:parent "path(.)" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotSubmissionLanguage a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm" ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:Language" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rdfs:comment "ND-LotTenderingTerms" ;
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.8 from v1.3-1.7 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with only relative XPath change, repeatable=false and other mapping-irrelevant changes
            rdfs:label "BT-97-Lot (value)" ;
            rdfs:comment "Submission Language of MG-SubmissionTerm under ND-LotSubmissionLanguage (v1.8+), ND-LotTenderingTerms (v1.3-1.7)" ;
            rr:predicate epo:hasLanguage ;
            rr:objectMap
                [
                    rdfs:label "at-voc:language" ;
                    rr:parentTriplesMap tedm:languageJSON ;
                    rr:joinCondition [
                        rr:child  "cbc:ID" ;
                        rr:parent "op_code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-Lot_ND-LotTenderingTerms a rr:TriplesMap ;
    rdfs:label "MG-Lot";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
             rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:comment "ND-LotTenderingTerms";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_Lot_{cbc:ID}" ;
            rr:class epo:Lot
        ] ;
      rr:predicateObjectMap
        [
            rdfs:label "BT-94-Lot";
            rdfs:comment "Recurrence MG-Lot under ND-LotTenderingTerms";
            rr:predicate epo:isRecurrent  ;
            rr:objectMap
                [
                    rml:reference "cac:TenderingTerms/cbc:RecurringProcurementIndicator";
                    rr:datatype xsd:boolean
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-95-Lot";
            rdfs:comment "Recurrence Description of MG-Lot under ND-LotTenderingTerms";
            rr:predicate epo:hasRecurrenceDescription   ;
            rr:objectMap
                [
                    rdfs:label "BT-95-Lot-Language";
                    rdfs:comment "Language of Recurrence Description of MG-Lot under ND-LotTenderingTerms";
                    rml:reference "cac:TenderingTerms/cbc:RecurringProcurementDescription";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cac:TenderingTerms/cbc:RecurringProcurementDescription/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
     rr:predicateObjectMap
        [
            rdfs:label "BT-60-Lot";
            rdfs:comment "EU Funds of MG-Lot under ND-LotTenderingTerms";
            rr:predicate epo:isUsingEUFunds;
            rr:objectMap
                [
                    rdfs:comment "translation of at-voc value 'eu-funds' to ePO value 'true'" ;
                    rml:reference "if(cac:TenderingTerms/cbc:FundingProgramCode[@listName='eu-funded']/text()='eu-funds') then 'true' else null";
                    rr:datatype xsd:boolean
                ]
                ,
                [
                    rdfs:comment "translation of at-voc value 'no-eu-funds' to ePO value 'false'" ;
                    rml:reference "if(cac:TenderingTerms/cbc:FundingProgramCode[@listName='eu-funded']/text()='no-eu-funds') then 'false' else null";
                    rr:datatype xsd:boolean
                ] ;
        ] ;
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotReservedExecution a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
        rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:ContractExecutionRequirement[cbc:ExecutionRequirementCode/@listName='reserved-execution']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotReservedExecution";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ContractTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}";
            rr:class epo:ContractTerm
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.9 from v1.3-1.8 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute and other mapping-irrelevant changes
            rdfs:label "BT-736-Lot";
            rdfs:comment "Reserved Execution of MG-ContractTerm under ND-LotReservedExecution(v1.9+), ND-LotTenderingTerms (v1.3-1.8)";
            rr:predicate epo:hasReservedExecution  ;
            rr:objectMap
                [
                    tedm:minSDKVersion "1.9.1" ;
                    rdfs:label "at-voc:applicability" ;
                    rr:parentTriplesMap tedm:applicability ;
                    rr:joinCondition [
                        rr:child "cbc:ExecutionRequirementCode";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotEInvoicing a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
        rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:ContractExecutionRequirement[cbc:ExecutionRequirementCode/@listName='einvoicing']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotEInvoicing";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ContractTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}";
            rr:class epo:ContractTerm
        ] ;
    rr:predicateObjectMap
        [
           # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
           # VERINFO: SDK v1.9 from v1.3-1.8 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute and other mapping-irrelevant changes
            rdfs:label "BT-743-Lot";
            rdfs:comment "Electronic Invoicing of MG-ContractTerm under ND-LotEInvoicing (v1.9+), ND-LotTenderingTerms (v1.3-1.8)";
            rr:predicate epo:hasEInvoicingPermission   ;
            rr:objectMap
                [
                    rdfs:label "at-voc:applicability" ;
                    rr:parentTriplesMap tedm:permission ;
                    rr:joinCondition [
                        rr:child "cbc:ExecutionRequirementCode";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ]
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-ExecutionRequirements a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:ContractExecutionRequirement[cbc:ExecutionRequirementCode/@listName='conditions']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-ExecutionRequirements";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ContractTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}";
            rr:class epo:ContractTerm
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-70-Lot";
            rdfs:comment "Terms Performance of MG-ContractTerm under ND-ExecutionRequirements";
            rr:predicate epo:hasPerformanceConditions ;
            rr:objectMap
                [
                    tedm:minSDKVersion "1.9.1" ;
                    rdfs:label "BT-70-Lot-Language";
                    rdfs:comment "Language of Terms Performance of MG-ContractTerm under ND-ExecutionRequirements";
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotProcurementScope a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
        rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotProcurementScope";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ContractTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw')}";
            rr:class epo:ContractTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-23-Lot";
            rdfs:comment "Main Nature of MG-ContractTerm under ND-LotProcurementScope";
            rr:predicate epo:hasContractNatureType    ;
            rr:objectMap
                [
                    rdfs:label "at-voc:contract-nature" ;
                    rr:parentTriplesMap tedm:contract-nature ;
                    rr:joinCondition [
                        rr:child "cbc:ProcurementTypeCode[@listName='contract-nature']";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-5101(a)-Lot, BT-5101(b)-Lot, BT-5101(s)-Lot, BT-5131-Lot, BT-5121-Lot, BT-5071-Lot, BT-5141-Lot ";
            rr:predicate epo:definesSpecificPlaceOfPerformance ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:Location-definesSpecificPlaceOfPerformance-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotPerformanceAddress ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(../..)";
                    ];
                ] ;
        ] ;
     rr:predicateObjectMap
        [
            rdfs:label "BT-36-Lot (object)";
            rr:predicate epo:definesContractDuration ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-SpecificDuration-definesContractDuration-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotDuration ;
                    rr:joinCondition[
                        rr:child "path(.)";
                        rr:parent "path(..)"
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-536-Lot, BT-537-Lot and BT-538-Lot";
            rr:predicate epo:definesContractPeriod ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Period-definesContractPeriod-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotDuration ;
                    rr:joinCondition[
                        rr:child "path(.)";
                        rr:parent "path(..)"
                    ];
                ] ;
        ] ;
.

tedm:MG-Quantity-hasTotalQuantity-Purpose-hasPurpose-Lot_ND-LotProcurementScope a rr:TriplesMap ;
    rdfs:label "MG-Quantity";
        rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotProcurementScope";
            rml:reference "if(exists(cbc:EstimatedOverallContractQuantity)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_Quantity_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null";
            rr:class epo:Quantity
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-25-Lot";
            rdfs:comment "Quantity of MG-Quantity under ND-LotProcurementScope";
            rr:predicate epo:hasQuantityValue     ;
            rr:objectMap
                [
                    rml:reference "cbc:EstimatedOverallContractQuantity";
                    rr:datatype xsd:decimal ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-625-Lot";
            rdfs:comment "Unit of Quantity of MG-Quantity under ND-LotProcurementScope";
            rr:predicate epo:hasUnitCode    ;
            rr:objectMap
                [
                     rdfs:label "at-voc:measurement-unit" ;
                    rr:parentTriplesMap tedm:measurement-unit ;
                    rr:joinCondition [
                        rr:child "cbc:EstimatedOverallContractQuantity/@unitCode";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-Purpose-hasPurpose-Lot_ND-LotProcurementScope a rr:TriplesMap ;
    rdfs:label "MG-Purpose";
        rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotProcurementScope";
            rml:reference "if(exists(cbc:EstimatedOverallContractQuantity)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_LotPurpose_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null";
            rr:class epo:Purpose
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-25-Lot, BT-625-Lot";
            rdfs:comment "Quantity of MG-Purpose under ND-LotProcurementScope";
            rr:predicate epo:hasTotalQuantity     ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Quantity-hasTotalQuantity-Purpose-hasPurpose-Lot_ND-LotProcurementScope ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(.)";
                    ];
                ] ;
        ]
.

tedm:MG-ProcurementCriterion-specifiesProcurementCriterion-Lot_ND-LotTenderingTerms a rr:TriplesMap ;
    rdfs:label "MG-ProcurementCriterion";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
             rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotTenderingTerms";
            rml:reference "if (exists(cbc:RequiredCurriculaCode)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_ProcurementCriterion_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw') else null" ;
            rr:class epo:ProcurementCriterion
        ] ;
      rr:predicateObjectMap
        [
            rdfs:label "BT-79-Lot";
            rdfs:comment "Performing Staff Qualification of MG-ProcurementCriterion under ND-LotTenderingTerms";
            rr:predicate epo:hasPerformingStaffQualificationInformation   ;
            rr:objectMap
                [
                    rdfs:label "at-voc:requirement-stage" ;
                    rr:parentTriplesMap tedm:requirement-stage ;
                    rr:joinCondition [
                        rr:child "cbc:RequiredCurriculaCode";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-SecurityClearanceTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingTerms a rr:TriplesMap ;
    rdfs:label "MG-SecurityClearanceTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
             rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotTenderingTerms";
            rml:reference "if (exists(cbc:LatestSecurityClearanceDate)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_SecurityClearanceTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:SecurityClearanceTerm
        ] ;
      rr:predicateObjectMap
        [
            rdfs:label "BT-78-Lot";
            rdfs:comment "Performing Staff Qualification of MG-SecurityClearanceTerm under ND-LotTenderingTerms";
            rr:predicate epo:hasDeadline    ;
            rr:objectMap
                [
                    rml:reference "cbc:LatestSecurityClearanceDate";
                    rr:datatype xsd:date;

                ] ;
        ] ;
.

tedm:MG-SecurityClearanceTerm-isSubjectToLotSpecificTerm-Lot_ND-SecurityClearanceTerms a rr:TriplesMap ;
    rdfs:label "MG-SecurityClearanceTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
             rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:SecurityClearanceTerm";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-SecurityClearanceTerms";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SecurityClearanceTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw')}" ;
            rr:class epo:SecurityClearanceTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-587-Lot";
            rdfs:comment "Security Clearance of MG-SecurityClearanceTerm under ND-SecurityClearanceTerms";
            rr:predicate epo:isSecurityClearanceRequired     ;
            rr:objectMap
                [
                    rml:reference "cbc:Code";
                    rr:datatype xsd:boolean ;

                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-732-Lot";
            rdfs:comment "Security Clearance Description of MG-SecurityClearanceTerm under ND-SecurityClearanceTerms";
            rr:predicate  dct:description ;
            rr:objectMap
                [
                    rdfs:label "BT-732-Lot-Language";
                    rdfs:comment "Language of Security Clearance Description of MG-SecurityClearanceTerm under ND-SecurityClearanceTerms";
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-NonDisclosureAgreementTerm-isSubjectToLotSpecificTerm-Lot_ND-NDA a rr:TriplesMap ;
    rdfs:label "MG-NonDisclosureAgreementTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
             rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:ContractExecutionRequirement[cbc:ExecutionRequirementCode/@listName='nda']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-NDA";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_NonDisclosureAgreementTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw')}" ;
            rr:class epo:NonDisclosureAgreementTerm
        ] ;
      rr:predicateObjectMap
        [
            # VERINFO: SDK v1.5-1.7 from v1.4 contain only node change with stylistic XPath changes yielding the same effective XPaths
            # VERINFO: SDK v1.8+ contain only stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute
            rdfs:label "BT-801-Lot";
            rdfs:comment "Non Disclosure Agreement of MG-NonDisclosureAgreementTerm under ND-NDA (v1.5+), ND-LotTenderingTerms (v1.3-1.4)";
            rr:predicate epo:isNonDisclosureAgreementRequired ;
            rr:objectMap
                [
                    tedm:minSDKVersion "1.8" ;
                    rml:reference "cbc:ExecutionRequirementCode";
                    rr:datatype xsd:boolean ;

                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-802-Lot";
            rdfs:comment "Non Disclosure Agreement Description of MG-NonDisclosureAgreementTerm under ND-NDA";
            rr:predicate dct:description;
            rr:objectMap
                [
                    rdfs:label "BT-802-Lot-Language";
                    rdfs:comment "Language of Non Disclosure Agreement Description of MG-NonDisclosureAgreementTerm under ND-NDA";
                    tedm:minSDKVersion "1.5.12" ;
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotESignature a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
             rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:ContractExecutionRequirement[cbc:ExecutionRequirementCode/@listName='esignature-submission']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotESignature";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
      rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.9 from v1.3-1.8 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute and other mapping-irrelevant changes
            rdfs:label "BT-744-Lot";
            rdfs:comment "Submission Electronic Signature of MG-SubmissionTerm under ND-LotESignature (v1.9+), ND-LotTenderingTerms (v1.3-1.8) ";
            rr:predicate epo:isAdvancedElectronicSignatureRequired     ;
            rr:objectMap
                [
                    rml:reference "cbc:ExecutionRequirementCode";
                    rr:datatype xsd:boolean ;
                ] ;
        ] ;
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-PostAwardProcess a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:PostAwardProcess";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-PostAwardProcess";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ContractTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}";
            rr:class epo:ContractTerm
        ] ;
      rr:predicateObjectMap
        [
            # Differences across versions have no functional effect on this mapping
            # VERINFO: SDK v1.9+ from 1.3-1.8 contain only node name change, along with other mapping-irrelevant changes
            rdfs:label "BT-93-Lot";
            rdfs:comment "Electronic Payment of MG-ContractTerm under ND-PostAwardProcess (v1.9+), ND-PostAwarProcess (v1.3-1.8)";
            rr:predicate epo:hasEPayment ;
            rr:objectMap
                [
                    rml:reference "cbc:ElectronicPaymentUsageIndicator";
                    rr:datatype xsd:boolean;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions have no functional effect on this mapping
            # VERINFO: SDK v1.9+ from 1.3-1.8 contain only node name change, along with other mapping-irrelevant changes
            rdfs:label "BT-92-Lot";
            rdfs:comment "ElectronicOrdering of MG-ContractTerm under ND-PostAwardProcess (v1.9+), ND-PostAwarProcess (v1.3-1.8)";
            rr:predicate epo:hasEOrdering ;
            rr:objectMap
                [
                    rml:reference "cbc:ElectronicOrderUsageIndicator";
                    rr:datatype xsd:boolean;
                ] ;
        ]
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-SubcontractingIndication a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:TenderSubcontractingRequirements";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-SubcontractingIndication";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../../../../../..)) || '?response_type=raw')}";
            rr:class epo:SubmissionTerm
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.8 from v1.3-1.7 contains rel XPath change within the same abs XPath due to node change, along with repeatable=false and introduction of List attribute
            rdfs:label "BT-651-Lot";
            rdfs:comment "SubcontractingTenderIndication of MG-SubmissionTerm under ND-SubcontractingIndication";
            rr:predicate epo:hasTenderSubcontractingInformation ;
            rr:objectMap
                [
                    rdfs:label "at-voc:subcontracting-indication" ;
                    rr:parentTriplesMap tedm:subcontracting-indication ;
                    rr:joinCondition [
                        rr:child "efbc:TenderSubcontractingRequirementsCode" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-SubcontractTerm-foreseesContractSpecificTerm-Lot_ND-SubcontractingObligation a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
    # the logicalSource/iterator along with corresponding predicateObjectMaps can be found in the version-specific derivatives of this RML file
    # Versioned mappings:
    # - v1.3-1.8
    # - v1.9+
    rr:subjectMap
        [
            rdfs:label "ND-SubcontractingObligation";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubcontractTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}";
            rr:class epo:SubcontractTerm
        ] ;
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-PaymentTerms a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:PaymentTerms";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-PaymentTerms";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ContractTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}";
            rr:class epo:ContractTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-77-Lot";
            rdfs:comment "Terms Financial of MG-ContractTerm under ND-PaymentTerms";
            rr:predicate epo:hasPaymentArrangement  ;
            rr:objectMap
                [
                    rdfs:label "BT-77-Lot-Language";
                    rdfs:comment "Language of Terms Financial of MG-ContractTerm under ND-PaymentTerms";
                    rml:reference "cbc:Note";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Note/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-FinancialGuarantee a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:RequiredFinancialGuarantee";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-FinancialGuarantee";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-751-Lot";
            rdfs:comment "Guarantee Required of MG-SubmissionTerm under ND-FinancialGuarantee";
            rr:predicate epo:isGuaranteeRequired  ;
            rr:objectMap
                [
                    rml:reference "cbc:GuaranteeTypeCode[@listName='tender-guarantee-required']";
                    rr:datatype xsd:boolean;
                ] ;
        ];
    rr:predicateObjectMap
        [
            # TODO min SDK 1.3 max SDK 1.3
            rdfs:label "BT-75-Lot";
            rdfs:comment "Guarantee Required Description of MG-SubmissionTerm under ND-FinancialGuarantee";
            rr:predicate epo:hasGuaranteeDescription ;
            rr:objectMap
                [
                    tedm:minSDKVersion "1.4" ;
                    rdfs:label "BT-75-Lot-Language";
                    rdfs:comment "Language of Guarantee Required Description of MG-SubmissionTerm under ND-FinancialGuarantee";
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-TenderRecipient a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:TenderRecipientParty";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-TenderRecipient";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-18-Lot";
            rdfs:comment "Submission URL of MG-SubmissionTerm under ND-TenderRecipient";
            rr:predicate epo:hasSubmissionURL   ;
            rr:objectMap
                [
                    rml:reference "cbc:EndpointID";
                    rr:datatype xsd:anyURI;
                ] ;
        ];
    rr:predicateObjectMap
        [
            rdfs:label "OPT-301-Lot-TenderReceipt" ;
            rdfs:comment "Connection of MG-SubmissionTerm to MG-TenderReceiver under ND-TenderRecipient" ;
            rr:predicate epo:definesTenderReceiver ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-TenderReceiver_ND-TenderRecipient ;
                    rr:joinCondition [
                        rr:child "path(.)" ;
                        rr:parent "path(.)" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-ProcurementDocument-involvesProcurementDocument-AccessTerm-isSubjectToLotSpecificTerm-Lot_ND-LotDocOfficialLanguage a rr:TriplesMap ;
    # subject template and predicate mappings are in versioned files (Lot_v1.3-1.7|v1.8-1.8|v1.9+)
    rdfs:label "MG-ProcurementDocument" ;
.

tedm:MG-AccessTerm-isSubjectToLotSpecificTerm-Lot_ND-LotProcurementDocument a rr:TriplesMap ;
    # some predicate mappings are in versioned files (various)
    rdfs:label "MG-AccessTerm" ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:CallForTendersDocumentReference";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotProcurementDocument";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_AccessTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:AccessTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-14-Lot";
            rdfs:comment "Documents Restricted of MG-AccessTerm under ND-LotProcurementDocument";
            rr:predicate epo:isProcurementDocumentRestricted  ;
            rr:objectMap
                [
                    rml:reference "if (cbc:DocumentType/text()='restricted-document') then 'true' else 'false'";
                    rr:datatype xsd:boolean
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.7 from v1.3-1.6 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute and other mapping-irrelevant changes
            rdfs:label "BT-615-Lot";
            rdfs:comment "Documents URL of MG-AccessTerm under ND-LotProcurementDocument (v1.7+), ND-LotRestrictedDocuments (v1.3-1.6)";
            rr:predicate epo:hasRestrictedAccessURL  ;
            rr:objectMap
                [
                    rml:reference "cac:Attachment[../cbc:DocumentType/text()='restricted-document']/cac:ExternalReference/cbc:URI";
                    rr:datatype xsd:anyURI;
                ] ;
        ]
.

tedm:MG-ProcurementDocument-involvesProcurementDocument-AccessTerm-isSubjectToLotSpecificTerm-Lot_ND-LotDocAllNonOfficialLanguages a rr:TriplesMap ;
    # subject template and predicate mappings are in versioned files (Lot_v1.3-1.8|v1.9+)
    rdfs:label "MG-ProcurementDocument" ;
.

tedm:MG-ReviewTerm-isSubjectToLotSpecificTerm-Lot_ND-ReviewPresentationPeriod a rr:TriplesMap ;
    rdfs:label  "MG-ReviewTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:AppealTerms/cac:PresentationPeriod";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label   "ND-ReviewPresentationPeriod";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ReviewTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:ReviewTerm
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.4 from v1.3-1.3 contains rel XPath change within the same abs XPath due to node change, along with only relative XPath change, introduction of attribute and other mapping-irrelevant changes
            rdfs:label "BT-99-Lot";
            rdfs:comment "Review Deadline Description of MG-ReviewTerm under ND-ReviewPresentationPeriod (v1.4+), ND-LotPlacePerformance (v1.3-1.3)";
            rr:predicate epo:hasReviewDeadlineInformation ;
            rr:objectMap
                [
                    rdfs:label "BT-99-Lot-Language";
                    rdfs:comment "Language of Review Deadline Description of MG-ReviewTerm under ND-ReviewPresentationPeriod";
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-StrategicProcurement-fulfillsStrategicProcurement-Lot_ND-StrategicProcurementType a rr:TriplesMap;
rdfs:label  "MG-StrategicProcurement";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:ProcurementAdditionalType[cbc:ProcurementTypeCode/@listName='strategic-procurement']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-StrategicProcurementType";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_StrategicProcurement_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw')}" ;
            rr:class epo:StrategicProcurement
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-777-Lot";
            rdfs:comment "Strategic Procurement Description of MG-StrategicProcurement under ND-StrategicProcurementType";
            rr:predicate epo:hasStrategicProcurementDescription ;
            rr:objectMap
                [
                    rdfs:label "BT-777-Lot-Language";
                    rdfs:comment "Language of Strategic Procurement Description of MG-StrategicProcurement under ND-StrategicProcurementType";
                    rml:reference "cbc:ProcurementType";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:ProcurementType/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.5 from v1.3-1.4 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with repeatable=false and other mapping-irrelevant changes
            # VERINFO: SDK v1.8+ from v1.5-1.7 contain only stylistic XPath changes (removing redundant predicate) and introduction of List attribute
            rdfs:label "BT-06-Lot" ;
            rdfs:comment "Strategic Procurement of MG-StrategicProcurement under ND-StrategicProcurementType (v1.5+), ND-LotProcurementScope (v1.3-1.4)" ;
            rr:predicate rdf:type ;
            rr:objectMap
                [
                    rml:reference "if (cbc:ProcurementTypeCode/text()='env-imp') then 'http://data.europa.eu/a4g/ontology#GreenProcurement' else null" ;
                    rr:termType rr:IRI ;
                ] ;
            rr:objectMap
                [
                    rml:reference "if (cbc:ProcurementTypeCode/text()='inn-pur') then 'http://data.europa.eu/a4g/ontology#InnovativeProcurement' else null" ;
                    rr:termType rr:IRI ;
                ] ;
            rr:objectMap
                [
                    rml:reference "if (cbc:ProcurementTypeCode/text()='soc-obj') then 'http://data.europa.eu/a4g/ontology#SocialProcurement' else null" ;
                    rr:termType rr:IRI ;
                ] ;
        ]
.

tedm:MG-GreenProcurement-fulfillsStrategicProcurement-Lot_ND-StrategicProcurementLot a rr:TriplesMap;
rdfs:label  "MG-GreenProcurement";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension/efac:StrategicProcurement";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-StrategicProcurementLot";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_GreenProcurement_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:GreenProcurement
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-717-Lot";
            rdfs:comment "CleanVehiclesDirective of MG-GreenProcurement under ND-StrategicProcurementLot";
            rr:predicate epo:usesCleanVehicleDirective   ;
            rr:objectMap
                [
                    tedm:minSDKVersion "1.9.1" ;
                    rml:reference "efbc:ApplicableLegalBasis";
                    rr:datatype xsd:boolean
                ] ;
        ]
.

tedm:MG-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotECatalog a rr:TriplesMap ;
    rdfs:label "MG-SubmissionTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:ContractExecutionRequirement[cbc:ExecutionRequirementCode/@listName='ecatalog-submission']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotECatalog";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SubmissionTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}" ;
            rr:class epo:SubmissionTerm
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.9 from v1.3-1.8 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute and other mapping-irrelevant changes
            rdfs:label "BT-764-Lot";
            rdfs:comment "Submission Electronic Catalogue of MG-SubmissionTerm under ND-LotECatalog (v1.9+), ND-LotTenderingProcess (v1.3-1.8)";
            rr:predicate epo:hasECataloguePermission   ;
            rr:objectMap
                [
                    rdfs:label "at-voc:permission:" ;
                    rr:parentTriplesMap tedm:permission;
                    rr:joinCondition [
                        rr:child "cbc:ExecutionRequirementCode" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-SpecificDuration-hasTenderValidityDuration-SubmissionTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingTerms a rr:TriplesMap ;
rdfs:label "MG-SpecificDuration";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            # TODO departure from CM MG iterator to instantiate at the right level
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:TenderValidityPeriod";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotTenderingTerms";
            rml:reference "if (exists(cbc:DurationMeasure)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_SpecificDuration_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:SpecificDuration
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-98-Lot (value)";
            rdfs:comment "Tender Validity Deadline of MG-SpecificDuration under ND-LotTenderingTerms";
            rr:predicate time:numericDuration ;
            rr:objectMap
                [
                    rml:reference "cbc:DurationMeasure";
                    rr:datatype xsd:decimal;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-98-Lot (unit)";
            rdfs:comment "Tender Validity Deadline of MG-SpecificDuration under ND-LotTenderingTerms";
            rr:predicate time:unitType ;
            rr:objectMap
                [
                    rdfs:label "BT-98-Lot-Unit (time:TemporalUnit)" ;
                    rdfs:comment "Unit of Tender Validity Deadline of MG-SpecificDuration under ND-LotTenderingTerms";
                    rr:parentTriplesMap tedm:temporal_unit ;
                    rr:joinCondition [
                        rr:child "cbc:DurationMeasure/@unitCode" ;
                        rr:parent "xmlElement" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-ReviewTerm-isSubjectToLotSpecificTerm-Lot_ND-LotReviewTerms a rr:TriplesMap ;
    rdfs:label "MG-ReviewTerm" ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms/cac:AppealTerms" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rdfs:label "ND-LotReviewTerms" ;
            rml:reference "if (exists(cac:AppealReceiverParty/cac:PartyIdentification/cbc:ID) or exists(cac:AppealInformationParty/cac:PartyIdentification/cbc:ID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_ReviewTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:ReviewTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "OPT-301-Lot-ReviewOrg" ;
            rdfs:comment "Review Organization Technical Identifier Reference of MG-ReviewTerm under ND-LotReviewTerms" ;
            rr:predicate epo:definesReviewer ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Reviewer_ND-LotReviewTerms ;
                    rr:joinCondition [
                        rr:child  "path(.)" ;
                        rr:parent "path(.)" ;
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "OPT-301-Lot-ReviewInfo" ;
            rdfs:comment "Review Info Provider Technical Identifier Reference of MG-ReviewTerm under ND-LotReviewTerms" ;
            rr:predicate epo:definesReviewProcedureInformationProvider ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ReviewProcedureInformationProvider_ND-LotReviewTerms ;
                    rr:joinCondition [
                        rr:child  "path(.)" ;
                        rr:parent "path(.)" ;
                    ] ;
                ] ;
         ] ;
.

# this is an example of an object referred to by multiple top-level subjects (all Lots) at orthogonal XPaths
tedm:MG-ExclusionGround-specifiesProcurementCriterion-Lot_ND-ExclusionGrounds a rr:TriplesMap ;
    rdfs:label "MG-ExclusionGround";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:TenderingTerms/cac:TendererQualificationRequest/cac:SpecificTendererRequirement";
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rdfs:label "ND-ExclusionGrounds";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ExclusionGround_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:ExclusionGround

        ] ;
   rr:predicateObjectMap
        [
            rdfs:label "BT-67(a)-Procedure";
            rdfs:comment "Exclusion Grounds of MG-ExclusionGround under ND-ExclusionGrounds";
            rr:predicate dct:type;
            rr:objectMap
                [
                    rml:reference "cbc:TendererRequirementTypeCode[@listName='exclusion-ground']";
                    rdfs:label "at-voc:criterion" ;
                     rr:parentTriplesMap tedm:criterion ;
                     rr:joinCondition [
                         rr:child "cbc:TendererRequirementTypeCode[@listName='exclusion-ground']" ;
                         rr:parent "code.value" ;
                     ] ;
                ] ;
        ] ;
   rr:predicateObjectMap
        [
            rdfs:label "BT-67(b)-Procedure";
            rdfs:comment "Exclusion Grounds of MG-ExclusionGround under ND-ExclusionGrounds";
            rr:predicate dct:description;
            rr:objectMap
                [
                    rdfs:label "BT-67(b)-Procedure-Language";
                    rdfs:comment "Language of Exclusion Grounds of MG-ExclusionGround under ND-ExclusionGrounds";
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotContractAdditionalNature a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
        rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:ProcurementAdditionalType[cbc:ProcurementTypeCode/@listName='contract-nature']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotContractAdditionalNature";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ContractTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}";
            rr:class epo:ContractTerm
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.8 from v1.3-1.7 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with repeatable=false, introduction of List attribute and other mapping-irrelevant changes
            rdfs:label "BT-531-Lot";
            rdfs:comment "Additional Nature (different from Main) of MG-ContractTerm under ND-LotContractAdditionalNature (v1.8+), ND-LotProcurementScope (v1.3-1.7)";
            rr:predicate epo:hasAdditionalContractNature    ;
            rr:objectMap
                [
                    rdfs:label "at-voc:contract-nature" ;
                    rr:parentTriplesMap tedm:contract-nature ;
                    rr:joinCondition [
                        rr:child "cbc:ProcurementTypeCode";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ]
.

tedm:MG-MonetaryValue-hasEstimatedValue-Lot_ND-LotValueEstimate a rr:TriplesMap ;
    rdfs:label "MonetaryValue";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:RequestedTenderTotal";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotValueEstimate ";
            rml:reference "if (exists(cbc:EstimatedOverallContractAmount)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_MonetaryValueLot_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(.)) || '?response_type=raw') else null" ;
            rr:class  epo:MonetaryValue;
        ] ;
    rr:predicateObjectMap
        [
            rr:predicate epo:hasAmountValue ;
            rr:objectMap
                [
                    rdfs:label  "BT-27-Lot";
                    rdfs:comment "Estimated Value of MG-MonetaryValue under ND-LotValueEstimate" ;
                    rml:reference "cbc:EstimatedOverallContractAmount";
                    rr:datatype xsd:decimal;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-27-Lot-Currency" ;
            rdfs:comment "Currency of Estimated Value of MG-MonetaryValue under ND-LotValueEstimate" ;
            rr:predicate epo:hasCurrency ;
            rr:objectMap
                [
                    rdfs:label "at-voc:currency" ;
                    rr:parentTriplesMap tedm:currency ;
                    rr:joinCondition [
                        rr:child "cbc:EstimatedOverallContractAmount/@currencyID" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-Purpose-hasPurpose-Lot_ND-LotMainClassification a rr:TriplesMap ;
    rdfs:label "MG-Purpose";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:MainCommodityClassification";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotMainClassification ";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_LotPurpose_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw')}" ;
            rr:class epo:Purpose;
        ] ;
    rr:predicateObjectMap
        [
            rr:predicate epo:hasMainClassification  ;
            rr:objectMap
                [
                    rdfs:label "BT-262-Lot";
                    rdfs:comment "Main Classification Code of MG-Purpose under ND-LotMainClassification";
                    rdfs:label "at-voc:cpv";
                    rr:parentTriplesMap tedm:cpv ;
                    rr:joinCondition [
                        rr:child  "if (cbc:ItemClassificationCode[@listName='cpv']) then cbc:ItemClassificationCode else null";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-Purpose-hasPurpose-Lot_ND-LotAdditionalClassification a rr:TriplesMap ;
    rdfs:label "MG-Purpose";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:AdditionalCommodityClassification";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotAdditionalClassification ";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_LotPurpose_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw')}" ;
            rr:class  epo:Purpose;
        ] ;
    rr:predicateObjectMap
        [
            rr:predicate epo:hasAdditionalClassification   ;
            rr:objectMap
                [
                    rdfs:label "BT-263-Lot";
                    rdfs:comment "Additional Classification Code of MG-Purpose under ND-LotAdditionalClassification";
                    rdfs:label "at-voc:cpv";
                    rr:parentTriplesMap tedm:cpv ;
                    rr:joinCondition [
                        rr:child "if (cbc:ItemClassificationCode[@listName='cpv']) then cbc:ItemClassificationCode else null";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-SocialProcurement-fulfillsStrategicProcurement-Lot_ND-LotSocialObjectiveType a rr:TriplesMap ;
    rdfs:label "MG-SocialProcurement";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:ProcurementAdditionalType[cbc:ProcurementTypeCode/@listName='social-objective']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotSocialObjectiveType ";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_SocialProcurement_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class  epo:SocialProcurement;
        ] ;
    rr:predicateObjectMap
        [
            rr:predicate epo:fulfillsRequirement ;
            rr:objectMap
                [
                    # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
                    # VERINFO: SDK v1.8 from v1.3-1.7 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with repeatable=false, introduction of List attribute and other mapping-irrelevant changes
                    rdfs:label "BT-775-Lot";
                    rdfs:comment "Social Procurement of MG-SocialProcurement under ND-LotSocialObjectiveType (v1.8+), ND-LotProcurementScope (v1.3-1.7)";
                    rdfs:label "at-voc:social-objective";
                    rr:parentTriplesMap tedm:social-objective ;
                    rr:joinCondition [
                        rr:child  "if (cbc:ProcurementTypeCode[@listName='social-objective']) then cbc:ProcurementTypeCode else null";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-InnovativeProcurement-fulfillsStrategicProcurement-Lot_ND-LotInnovativeAcquisitionType a rr:TriplesMap ;
    rdfs:label "MG-InnovativeProcurement";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:ProcurementAdditionalType[cbc:ProcurementTypeCode/@listName='innovative-acquisition']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotInnovativeAcquisitionType ";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_InnovativeProcurement_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class  epo:InnovativeProcurement;
        ] ;
    rr:predicateObjectMap
        [
            rr:predicate epo:fulfillsRequirement ;
            rr:objectMap
                [
                    # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
                    # VERINFO: SDK v1.6 from v1.3-1.5 contains field name change only
                    # VERINFO: SDK v1.8 from v1.6-1.7 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with repeatable=false and introduction of List attribute
                    rdfs:label "BT-776-Lot";
                    rdfs:comment "Procurement of Innovation (v1.6+) of MG-InnovativeProcurement under ND-LotInnovativeAcquisitionType (v1.8+), ND-LotProcurementScope (v1.3-1.7)";
                    rdfs:comment "Innovative Procurement (v1.3-1.5) of MG-InnovativeProcurement under ND-LotProcurementScope (v1.3-1.7)";
                    rdfs:label "at-voc:innovative-acquisition";
                    rr:parentTriplesMap tedm:innovative-acquisition ;
                    rr:joinCondition [
                        rr:child "if (cbc:ProcurementTypeCode[@listName='innovative-acquisition']) then cbc:ProcurementTypeCode else null";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-AccessTerm-isSubjectToLotSpecificTerm-Lot_ND-LotTenderingTerms a rr:TriplesMap ;
    rdfs:label "MG-AccessTerm" ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:TenderingTerms" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rdfs:label "ND-LotTenderingTerms" ;
            rml:reference "if (exists(cac:AdditionalInformationParty/cac:PartyIdentification/cbc:ID) or exists(cac:DocumentProviderParty/cac:PartyIdentification/cbc:ID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_AccessTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:AccessTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "OPT-301-Lot-AddInfo" ;
            rdfs:comment "Additional Info Provider Technical Identifier Reference of MG-AccessTerm under ND-LotTenderingTerms" ;
            rr:predicate epo:definesProcurementProcedureInformationProvider ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-ProcurementProcedureInformationProvider_ND-LotTenderingTerms ;
                    rr:joinCondition [
                        rr:child  "path(.)" ;
                        rr:parent "path(.)" ;
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label   "OPT-301-Lot-DocProvider" ;
            rdfs:comment "Document Provider Technical Identifier Reference of MG-AccessTerm under ND-LotTenderingTerms" ;
            rr:predicate epo:definesOfflineAccessProvider ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-OfflineAccessProvider_ND-LotTenderingTerms ;
                    rr:joinCondition
                     [
                        rr:child  "path(.)" ;
                        rr:parent "path(.)" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-GreenProcurement-fulfillsStrategicProcurement-Lot_ND-LotEnvironmentalImpactType a rr:TriplesMap ;
    rdfs:label "MG-GreenProcurement";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:ProcurementAdditionalType[cbc:ProcurementTypeCode/@listName='environmental-impact']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotEnvironmentalImpactType ";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_GreenProcurement_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class  epo:GreenProcurement;
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.8 from v1.3-1.7 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with repeatable=false, introduction of List attribute and other mapping-irrelevant changes
            rdfs:label "BT-774-Lot";
            rdfs:comment "GreenProcurement of MG-GreenProcurement under ND-LotEnvironmentalImpactType (v1.8+), ND-LotProcurementScope (v1.3-1.7)";
            rr:predicate epo:fulfillsRequirement ;
            rr:objectMap
                [
                    rdfs:label "at-voc:innovative-acquisition";
                    rr:parentTriplesMap tedm:environmental-impact ;
                    rr:joinCondition [
                        rr:child  "if (cbc:ProcurementTypeCode[@listName='environmental-impact']) then cbc:ProcurementTypeCode else null";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-GreenProcurement-fulfillsStrategicProcurement-Lot_ND-LotGreenCriteria a rr:TriplesMap ;
    rdfs:label "MG-GreenProcurement";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:ProcurementAdditionalType[cbc:ProcurementTypeCode/@listName='gpp-criteria']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotGreenCriteria ";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_GreenProcurement_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class  epo:GreenProcurement;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-805-Lot";
            rdfs:comment "GreenProcurementCriteria of MG-GreenProcurement under ND-LotGreenCriteria";
            rr:predicate epo:fulfillsRequirement   ;
            rr:objectMap
                [
                    tedm:minSDKVersion "1.9.1" ;
                    rdfs:label "at-voc:green-public-procurement-criteria";
                    rr:parentTriplesMap tedm:green-public-procurement-criteria ;
                    rr:joinCondition [
                        rr:child  "cbc:ProcurementTypeCode";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-StrategicProcurement-fulfillsStrategicProcurement-Lot-Lot_ND-AccessibilityJustification a rr:TriplesMap ;
    rdfs:label "MG-StrategicProcurement";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:ProcurementAdditionalType[cbc:ProcurementTypeCode/@listName='accessibility']";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-AccessibilityJustification ";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_StrategicProcurement_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw')}" ;
            rr:class  epo:StrategicProcurement;
        ] ;
    rr:predicateObjectMap
        [
            # VERINFO: SDK v1.5-1.7 from 1.4 contain only node change with stylistic XPath changes yielding the same effective XPaths, along with repeatable=false
            # VERINFO: SDK v1.8+ contain only stylistic XPath changes yielding the same effective XPaths, along with introduction of List attribute
            rdfs:label "BT-754-Lot";
            rdfs:comment "Accessibility  of MG-StrategicProcurement under ND-AccessibilityJustification (v1.5+), ND-LotProcurementScope (v1.3-1.4)";
            rr:predicate epo:includesAccessibilityCriterion ;
            rr:objectMap
                [
                    tedm:minSDKVersionn "1.8" ;
                    rdfs:label "at-voc:accessibility";
                    rr:parentTriplesMap tedm:accessibility ;
                    rr:joinCondition [
                        rr:child  "cbc:ProcurementTypeCode";
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-755-Lot";
            rdfs:comment "Accessibility Justification of MG-StrategicProcurement under ND-AccessibilityJustification";
            rr:predicate epo:hasNonAccessibilityCriterionJustification  ;
            rr:objectMap
                [
                    rdfs:label "BT-755-Lot-Language";
                    rdfs:comment "Language of Accessibility Justification of MG-StrategicProcurement under ND-AccessibilityJustification";
                    rml:reference "cbc:ProcurementType";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:ProcurementType/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-Address-address-Location-definesSpecificPlaceOfPerformance-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotPerformanceAddress a rr:TriplesMap ;
 rdfs:label "MG-Address" ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:RealizedLocation/cac:Address";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:comment "ND-LotPerformanceAddress";
            rml:reference "if(exists(cbc:StreetName) or exists(cbc:AdditionalStreetName) or exists(cac:AddressLine/cbc:Line) or exists(cbc:CityName) or exists(cbc:PostalZone) or exists(cac:Country/cbc:IdentificationCode)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_ContractLocationAddress_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class locn:Address
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.5 from v1.3-1.4 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with only relative XPath change and other mapping-irrelevant changes
            rdfs:label "BT-5101(a|b|c)-, BT-5121-, BT-5131-, 5141-lot" ;
            rdfs:comment "Place Performance Street, Place Performance Streetline 1, Place Performance Streetline 2, Place Performance City, Place Performance Post Code, Place Performance Country Code under ND-LotPerformanceAddress (v1.5+), ND-LotPlacePerformance (v1.3-1.4)" ;
            rr:predicate locn:fullAddress ;
            rr:objectMap
                [
                   rml:reference  "if (exists(cbc:StreetName) or exists(cbc:AdditionalStreetName) or exists(cac:AddressLine/cbc:Line)) then replace(replace(cbc:StreetName || ', ' || cbc:AdditionalStreetName || ', ' || cac:AddressLine/cbc:Line || ', ' || cbc:CityName || ', ' || cbc:PostalZone || ', ' || cac:Country/cbc:IdentificationCode, '(, )+', ', '),  '^, |, $', '') else null" ;

                ] ;
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.5 from v1.3-1.4 contains rel XPath change within the same abs XPath due to node change, along with other mapping-irrelevant changes
            rdfs:label "BT-5131-Lot";
            rdfs:comment "Place Performance City of MG-Address under ND-LotPerformanceAddress (v1.5+), ND-LotPlacePerformance (v1.3-1.4)";
            rr:predicate locn:postName ;
            rr:objectMap
                [
                    rml:reference "cbc:CityName";
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.5 from v1.3-1.4 contains rel XPath change within the same abs XPath due to node change, along with other mapping-irrelevant changes
            rdfs:label "BT-5121-Lot";
            rdfs:comment "Place Performance Post Code of MG-Address under ND-LotPerformanceAddress (v1.5+), ND-LotPlacePerformance (v1.3-1.4)";
            rr:predicate locn:postCode ;
            rr:objectMap
                [
                    rml:reference "cbc:PostalZone";
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.5 from v1.3-1.4 contains rel XPath change within the same abs XPath due to node change, along with only relative XPath change, introduction of attribute and other mapping-irrelevant changes
            rdfs:label "BT-5071-lot";
            rdfs:comment "Place Performance Country Subdivision of MG-Location under ND-LotPerformanceAddress (v1.5+), ND-LotPlacePerformance (v1.3-1.4)";
            rr:predicate epo:hasNutsCode ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:nuts ;
                    rr:joinCondition [
                        rr:child "cbc:CountrySubentityCode" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.5 from v1.3-1.4 contains rel XPath change within the same abs XPath due to node change, along with only relative XPath change, introduction of attribute and other mapping-irrelevant changes
            rdfs:label "BT-5141-lot";
            rdfs:comment "Place Performance Country Code of MG-Location under ND-LotPerformanceAddress (v1.5+), ND-LotPlacePerformance (v1.3-1.4)" ;
            rr:predicate epo:hasCountryCode ;
            rr:objectMap
                [
                    rdfs:label "at-voc:country" ;
                    rr:parentTriplesMap tedm:country ;
                    rr:joinCondition [
                        rr:child "cac:Country/cbc:IdentificationCode" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:Location-definesSpecificPlaceOfPerformance-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotPerformanceAddress a rr:TriplesMap ;
 rdfs:label  "MG-Location" ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:RealizedLocation/cac:Address";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label  "ND-LotPerformanceAddress" ;
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ContractLocation_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class dct:Location
        ];
    rr:predicateObjectMap
        [
            rdfs:label "BT-5101(a)-Lot, BT-5101(b)-Lot, BT-5101(c)-Lot, BT-5131-Lot, BT-5121-Lot ";
            rr:predicate locn:address ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:MG-Address-address-Location-definesSpecificPlaceOfPerformance-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotPerformanceAddress ;
                    rr:joinCondition [
                        rr:child "path(.)";
                        rr:parent "path(.)";
                    ];
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-5071-Lot" ;
            rdfs:comment "Place Performance Country Subdivision of MG-Location under ND-LotPerformanceAddress (v1.5+), ND-LotDPSContractingSystem (v1.3-1.4)";
            rr:predicate epo:hasNutsCode ;
            rr:objectMap
                [
                    rr:parentTriplesMap tedm:nuts ;
                    rr:joinCondition [
                        rr:child "cbc:CountrySubentityCode" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-5141-Lot" ;
            rdfs:comment "Place Performance Country Code of MG-Location under ND-LotPerformanceAddress" ;
            rr:predicate epo:hasCountryCode ;
            rr:objectMap
                [
                    rdfs:label "at-voc:country" ;
                    rr:parentTriplesMap tedm:country ;
                    rr:joinCondition [
                        rr:child "cac:Country/cbc:IdentificationCode" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotPerformanceAddress a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
        rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:RealizedLocation/cac:Address";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotPerformanceAddress";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ContractTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../../..)) || '?response_type=raw')}";
            rr:class epo:ContractTerm
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.5 from v1.3-1.4 contains only node change with stylistic XPath changes yielding the same effective XPaths, along with only relative XPath change and other mapping-irrelevant changes
            rdfs:label "BT-727-Lot";
            rdfs:comment "Place Performance Services Other of MG-ContractTerm under ND-LotPerformanceAddress  ND-LotPerformanceAddress (v1.5+), ND-LotPlacePerformance (v1.3-1.4)";
            rr:predicate epo:hasBroadPlaceOfPerformance     ;
            rr:objectMap
                [
                    rdfs:label "at-voc:other-place-service";
                    rr:parentTriplesMap tedm:other-place-service ;
                    rr:joinCondition [
                        rr:child "cbc:Region" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ];
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotPlacePerformance a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
        rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:RealizedLocation";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotProcurementScope";
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-')}_ContractTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw')}";
            rr:class epo:ContractTerm
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-728-Lot" ;
            rdfs:comment "Place Performance Additional Information of MG-ContractTerm under ND-LotPlacePerformance" ;
            rr:predicate epo:hasPlaceOfPerformanceAdditionalInformation ;
            rr:objectMap
                [
                    rdfs:label "BT-728-Lot-Language" ;
                    rdfs:comment "Language of Place Performance Additional Information of MG-ContractTerm under ND-LotPlacePerformance" ;
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-SpecificDuration-definesContractDuration-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotDuration a rr:TriplesMap ;
    rdfs:label "MG-SpecificDuration";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:PlannedPeriod";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotDuration";
            rml:reference "if (exists(cbc:DurationMeasure)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_ContractDuration_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:SpecificDuration
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-36-Lot (value)";
            rdfs:comment "Duration Period of MG-SpecificDuration under ND-LotDuration";
            rr:predicate  time:numericDuration;
            rr:objectMap
                [
                    rml:reference "cbc:DurationMeasure";
                    rr:datatype xsd:decimal;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-36-Lot (unit)";
            rdfs:comment "Duration Period of MG-SpecificDuration under ND-LotDuration";
            rr:predicate time:unitType ;
            rr:objectMap
                [
                    rdfs:label "BT-36-Lot-Unit (time:TemporalUnit)" ;
                    rdfs:comment "Unit of Duration Period of MG-SpecificDuration under ND-LotDuration";
                    rr:parentTriplesMap tedm:temporal_unit ;
                    rr:joinCondition [
                        rr:child "cbc:DurationMeasure/@unitCode" ;
                        rr:parent "xmlElement" ;
                    ] ;
                ] ;
        ] ;
.

tedm:MG-Period-definesContractPeriod-ContractTerm-foreseesContractSpecificTerm-Lot_ND-LotDuration a rr:TriplesMap ;
    rdfs:label "MG-Period";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:PlannedPeriod";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotDuration";
            rml:reference "if (exists(cbc:StartDate) or exists(cbc:EndDate) or exists(cbc:DescriptionCode)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_ContractPeriod_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Period
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-536-Lot";
            rdfs:comment "Duration Start Date of MG-Period under ND-LotDuration";
            rr:predicate  epo:hasBeginning;
            rr:objectMap
                [
                    rml:reference "cbc:StartDate";
                    rr:datatype xsd:date;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-537-Lot";
             rdfs:comment "Duration Start Date of MG-Period under ND-LotDuration";
            rr:predicate  epo:hasEnd;
            rr:objectMap
                [
                    rml:reference "cbc:EndDate";
                    rr:datatype xsd:date;
                ] ;
        ];
    rr:predicateObjectMap
        [
            # VERINFO: across versions only mapping-irrelevant changes, and introduction of List attribute from 1.9+
            rdfs:label "BT-538-Lot";
            rdfs:comment "Duration Other of MG-SpecificDuration under ND-LotDuration";
            rr:predicate  epo:hasTimePeriod;
            rr:objectMap
                [
                    rdfs:label "at-voc:timeperiod";
                    rr:parentTriplesMap tedm:timeperiod ;
                    rr:joinCondition [
                        rr:child "cbc:DescriptionCode" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ]
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-OptionsAndRenewals a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:ContractExtension";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-OptionsAndRenewals";
            rml:reference "if (exists(cbc:OptionsDescription) or exists(cbc:MaximumNumberNumeric))  then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_ContractTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../..)) || '?response_type=raw') else null" ;
            rr:class  epo:ContractTerm;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-54-Lot";
            rdfs:comment "Options Description of MG-ContractTerm under ND-OptionsAndRenewals";
            rr:predicate epo:hasOptionsDescription ;
            rr:objectMap
                [
                    rdfs:label "BT-54-Lot-Language";
                    rdfs:comment "Language of Options Description of MG-ContractTerm under ND-OptionsAndRenewals";
                    rml:reference "cbc:OptionsDescription";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:OptionsDescription/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            # VERINFO: across versions only mapping-irrelevant changes
            rdfs:label "BT-58-Lot";
            rdfs:comment "Renewal Maximum of MG-ContractTerm under ND-OptionsAndRenewals";
            rr:predicate epo:hasMaximumNumberOfRenewals ;
            rr:objectMap
                [
                    rml:reference "cbc:MaximumNumberNumeric";
                    rr:datatype xsd:integer;
                ] ;
        ] ;
.

tedm:MG-ContractTerm-foreseesContractSpecificTerm-Lot_ND-OptionsDescription a rr:TriplesMap ;
    rdfs:label "MG-ContractTerm";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:ContractExtension/cac:Renewal/cac:Period";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-OptionsAndRenewals";
            rml:reference "if (exists(cbc:Description)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_ContractTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(../../../..)) || '?response_type=raw') else null" ;
            rr:class  epo:ContractTerm;
        ] ;
    rr:predicateObjectMap
        [
            # Differences across versions are practically superficial and have little to no functional effect on this mapping even though different iterators can be interpreted
            # VERINFO: SDK v1.5 from v1.3-1.4 contains rel XPath change within the same abs XPath due to node change, along with only relative XPath change, introduction of attribute and other mapping-irrelevant changes
            rdfs:label "BT-57-Lot";
            rdfs:comment "Renewal Description of MG-ContractTerm under ND-OptionsAndRenewals (v1.5+), ND-OptionsAndRenewals (v1.3-1.4)";
            rr:predicate epo:hasRenewalDescription ;
            rr:objectMap
                [
                    rdfs:label "BT-57-Lot-Language";
                    rdfs:comment "Language of Renewal Description of MG-ContractTerm under ND-OptionsAndRenewals" ;
                    rml:reference "cbc:Description";
                    rml:languageMap [
                        fnml:functionValue [
                            rr:predicateObjectMap [
                                rr:predicate idlab-fn:str ;
                                rr:objectMap [ rml:reference "cbc:Description/@languageID" ]
                            ] ,
                            tedm:idlab-fn_executes_lookup ,
                            tedm:idlab-fn_inputFile_language ,
                            tedm:idlab-fn_fromColumn_code ,
                            tedm:idlab-fn_toColumn_code
                        ]
                    ] ;
                ] ;
        ] ;
.

tedm:MG-MonetaryValue-hasLaunchFrameworkAgreementMaximumValue-Lot_ND-LotValueEstimateExtension a rr:TriplesMap ;
    rdfs:label "MG-MonetaryValue";
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/*/cac:ProcurementProjectLot[cbc:ID/@schemeName='Lot']/cac:ProcurementProject/cac:RequestedTenderTotal/ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/efext:EformsExtension";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rdfs:label "ND-LotValueEstimateExtension";
            rml:reference "if (exists(efbc:FrameworkMaximumAmount)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/*/cbc:ID[@schemeName='notice-id'], ' ', '-' ), '/' , '-') || '_LotValueEstimateExtension_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-271-Lot";
            rdfs:comment "Framework Maximum Value of MG-MonetaryValue under ND-LotValueEstimateExtension";
            rr:predicate epo:hasAmountValue ;
            rr:objectMap
                [
                    tedm:minSDKVersion "1.5.12" ;
                    rml:reference "efbc:FrameworkMaximumAmount";
                    rr:datatype xsd:decimal;
                ] ;
        ] ;
    rr:predicateObjectMap
        [
            rdfs:label "BT-271-Lot-Currency";
            rdfs:comment "Currency of Framework Maximum Value of MG-MonetaryValue under ND-LotValueEstimateExtension";
            rr:predicate epo:hasCurrency ;
            rr:objectMap
                [
                    rdfs:label "at-voc:currency" ;
                    rr:parentTriplesMap tedm:currency ;
                    rr:joinCondition [
                        rr:child "efbc:FrameworkMaximumAmount/@currencyID" ;
                        rr:parent "code.value" ;
                    ] ;
                ] ;
        ] ;
.
